<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Swethaa">
<meta name="dcterms.date" content="2023-11-19">

<title>CS 5805 - Linear and nonlinear regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">CS 5805</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Linear and nonlinear regression</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Swethaa </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 19, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<h3 class="anchored">a)Linear Regression
</h3> 
    <h3 class="anchored">Index</h3>
    <ul>
        <li>What is Linear Regression</li>
        <li>Types of Linear Regression</li>
        <li>Training a Linear Regression Model</li>
        <li>Finding the best fit line</li>
    </ul>
    <h3 class="anchored">What is Linear Regression</h3>
    <p>Linear regression is one of the easiest and most popular Machine Learning algorithms. It is a statistical method that is used for predictive analysis. Linear regression makes predictions for continuous/real or numeric variables such as sales, salary,
        age, product price, etc.</p>
    <p>Mathematically, we can represent a linear regression as:</p>
    <b>y= a0+a1x+ ε</b>
    <ul>
        <li>Y= Dependent Variable (Target Variable)</li>
        <li>X= Independent Variable (predictor Variable)</li>
        <li>a0= intercept of the line (Gives an additional degree of freedom)</li>
        <li>a1 = Linear regression coefficient (scale factor to each input value).</li>
        <li>ε = random error</li>
    </ul>
    <p></p> The values for x and y variables are training datasets for Linear Regression model representation.<p></p>
    <h3 class="anchored">Types of Linear Regression</h3>
    <ul>
        <li> <b>Simple Linear Regression</b>
            <p>If a single independent variable is used to predict the value of a numerical dependent variable, then such a Linear Regression algorithm is called Simple Linear Regression.</p>
            <h4 class="anchored"> <b>Y=β 0+β 1⋅X+ε</b></h4>
            <ul>
                <li>
                    Y is the dependent variable.
                </li>
                <li>X is the independent variable.</li>
                <li>β 0is the intercept (where the line crosses theY-axis).</li>
                <li>β 1 is the slop (the change in Y for a one-unitchange in X).</li>
                <li>ε is the error term, representing the variability in Y that is not explained by the linear relationship withX</li>
            </ul>
        </li>
        <li> <b>Multiple Linear Regression</b>
            <p>If more than one independent variable is used to predict the value of a numerical dependent variable, then such a Linear Regression algorithm is called Multiple Linear Regression.</p>
            <h4 class="anchored"> <b>Y=β 0+β 1⋅X 1 +β 2⋅X 2 +…+β n⋅X n+ε </b></h4>
            <ul>
                <li>
                    Y is the dependent variable.
                </li>
                <li>X 1,X 2,…,Xn are the independent variables</li>
                <li>β 0is the intercept </li>
                <li>β1,β 2,…,β nare the coefficients representing the impact of each independent variable.</li>
                <li>ε is the error term</li>
            </ul>
        </li>
    </ul>
    <h3 class="anchored">Training a Linear Regression Model</h3>
    <p>The process of training a linear regression model involves finding the values of the coefficients (β0,β 1,…,βn) that minimize the sum of squared differences between the predicted and actual values in the training data.</p>
    <h3 class="anchored">Finding the best fit line</h3>
    <p>goal is to find the best fit line that means the error between predicted values and actual values should be minimized. The best fit line will have the least error. The different values for weights or the coefficient of lines (a0, a1) gives a different
        line of regression, so we need to calculate the best values for a0 and a1 to find the best fit line, so to calculate this we use cost function.</p>
    <h3 class="anchored">Continuous random variable</h3>
    <p>A continuous random variable has two main characteristics:</p>
    <p>the set of its possible values is uncountable;
we compute the probability that its value will belong to a given interval by integrating a function called probability density function.</p>
    <h3 class="anchored">Common continuous distributions</h3>
    <p>The next table contains some examples of continuous distributions that are frequently encountered in probability theory and statistics.</p>
    
<table data-quarto-postprocess="true" class="table">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Name of the continuous distribution</td>
<td data-quarto-table-cell-role="th">Support</td>
</tr>
<tr class="even">
<td>Uniform</td>
<td>All the real numbers in the interval [0,1]</td>
</tr>
<tr class="odd">
<td>Normal</td>
<td>The whole set of real numbers</td>
</tr>
<tr class="even">
<td>Chi-square</td>
<td>The set of all non-negative real numbers</td>
</tr>
</tbody>
</table>

    <img src="Image2.png" alt="" height="300px" width="300px">
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> GradientBoostingRegressor</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_error</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'CarPrice_Assignment.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">car_ID</th>
<th data-quarto-table-cell-role="th">symboling</th>
<th data-quarto-table-cell-role="th">CarName</th>
<th data-quarto-table-cell-role="th">fueltype</th>
<th data-quarto-table-cell-role="th">aspiration</th>
<th data-quarto-table-cell-role="th">doornumber</th>
<th data-quarto-table-cell-role="th">carbody</th>
<th data-quarto-table-cell-role="th">drivewheel</th>
<th data-quarto-table-cell-role="th">enginelocation</th>
<th data-quarto-table-cell-role="th">wheelbase</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">enginesize</th>
<th data-quarto-table-cell-role="th">fuelsystem</th>
<th data-quarto-table-cell-role="th">boreratio</th>
<th data-quarto-table-cell-role="th">stroke</th>
<th data-quarto-table-cell-role="th">compressionratio</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">peakrpm</th>
<th data-quarto-table-cell-role="th">citympg</th>
<th data-quarto-table-cell-role="th">highwaympg</th>
<th data-quarto-table-cell-role="th">price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>3</td>
<td>alfa-romero giulia</td>
<td>gas</td>
<td>std</td>
<td>two</td>
<td>convertible</td>
<td>rwd</td>
<td>front</td>
<td>88.6</td>
<td>...</td>
<td>130</td>
<td>mpfi</td>
<td>3.47</td>
<td>2.68</td>
<td>9.0</td>
<td>111</td>
<td>5000</td>
<td>21</td>
<td>27</td>
<td>13495.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>3</td>
<td>alfa-romero stelvio</td>
<td>gas</td>
<td>std</td>
<td>two</td>
<td>convertible</td>
<td>rwd</td>
<td>front</td>
<td>88.6</td>
<td>...</td>
<td>130</td>
<td>mpfi</td>
<td>3.47</td>
<td>2.68</td>
<td>9.0</td>
<td>111</td>
<td>5000</td>
<td>21</td>
<td>27</td>
<td>16500.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>1</td>
<td>alfa-romero Quadrifoglio</td>
<td>gas</td>
<td>std</td>
<td>two</td>
<td>hatchback</td>
<td>rwd</td>
<td>front</td>
<td>94.5</td>
<td>...</td>
<td>152</td>
<td>mpfi</td>
<td>2.68</td>
<td>3.47</td>
<td>9.0</td>
<td>154</td>
<td>5000</td>
<td>19</td>
<td>26</td>
<td>16500.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>2</td>
<td>audi 100 ls</td>
<td>gas</td>
<td>std</td>
<td>four</td>
<td>sedan</td>
<td>fwd</td>
<td>front</td>
<td>99.8</td>
<td>...</td>
<td>109</td>
<td>mpfi</td>
<td>3.19</td>
<td>3.40</td>
<td>10.0</td>
<td>102</td>
<td>5500</td>
<td>24</td>
<td>30</td>
<td>13950.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>2</td>
<td>audi 100ls</td>
<td>gas</td>
<td>std</td>
<td>four</td>
<td>sedan</td>
<td>4wd</td>
<td>front</td>
<td>99.4</td>
<td>...</td>
<td>136</td>
<td>mpfi</td>
<td>3.19</td>
<td>3.40</td>
<td>8.0</td>
<td>115</td>
<td>5500</td>
<td>18</td>
<td>22</td>
<td>17450.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 26 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>Index(['car_ID', 'symboling', 'CarName', 'fueltype', 'aspiration',
       'doornumber', 'carbody', 'drivewheel', 'enginelocation', 'wheelbase',
       'carlength', 'carwidth', 'carheight', 'curbweight', 'enginetype',
       'cylindernumber', 'enginesize', 'fuelsystem', 'boreratio', 'stroke',
       'compressionratio', 'horsepower', 'peakrpm', 'citympg', 'highwaympg',
       'price'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 205 entries, 0 to 204
Data columns (total 26 columns):
 #   Column            Non-Null Count  Dtype  
---  ------            --------------  -----  
 0   car_ID            205 non-null    int64  
 1   symboling         205 non-null    int64  
 2   CarName           205 non-null    object 
 3   fueltype          205 non-null    object 
 4   aspiration        205 non-null    object 
 5   doornumber        205 non-null    object 
 6   carbody           205 non-null    object 
 7   drivewheel        205 non-null    object 
 8   enginelocation    205 non-null    object 
 9   wheelbase         205 non-null    float64
 10  carlength         205 non-null    float64
 11  carwidth          205 non-null    float64
 12  carheight         205 non-null    float64
 13  curbweight        205 non-null    int64  
 14  enginetype        205 non-null    object 
 15  cylindernumber    205 non-null    object 
 16  enginesize        205 non-null    int64  
 17  fuelsystem        205 non-null    object 
 18  boreratio         205 non-null    float64
 19  stroke            205 non-null    float64
 20  compressionratio  205 non-null    float64
 21  horsepower        205 non-null    int64  
 22  peakrpm           205 non-null    int64  
 23  citympg           205 non-null    int64  
 24  highwaympg        205 non-null    int64  
 25  price             205 non-null    float64
dtypes: float64(8), int64(8), object(10)
memory usage: 41.8+ KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">car_ID</th>
<th data-quarto-table-cell-role="th">symboling</th>
<th data-quarto-table-cell-role="th">wheelbase</th>
<th data-quarto-table-cell-role="th">carlength</th>
<th data-quarto-table-cell-role="th">carwidth</th>
<th data-quarto-table-cell-role="th">carheight</th>
<th data-quarto-table-cell-role="th">curbweight</th>
<th data-quarto-table-cell-role="th">enginesize</th>
<th data-quarto-table-cell-role="th">boreratio</th>
<th data-quarto-table-cell-role="th">stroke</th>
<th data-quarto-table-cell-role="th">compressionratio</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">peakrpm</th>
<th data-quarto-table-cell-role="th">citympg</th>
<th data-quarto-table-cell-role="th">highwaympg</th>
<th data-quarto-table-cell-role="th">price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
<td>205.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>103.000000</td>
<td>0.834146</td>
<td>98.756585</td>
<td>174.049268</td>
<td>65.907805</td>
<td>53.724878</td>
<td>2555.565854</td>
<td>126.907317</td>
<td>3.329756</td>
<td>3.255415</td>
<td>10.142537</td>
<td>104.117073</td>
<td>5125.121951</td>
<td>25.219512</td>
<td>30.751220</td>
<td>13276.710571</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>59.322565</td>
<td>1.245307</td>
<td>6.021776</td>
<td>12.337289</td>
<td>2.145204</td>
<td>2.443522</td>
<td>520.680204</td>
<td>41.642693</td>
<td>0.270844</td>
<td>0.313597</td>
<td>3.972040</td>
<td>39.544167</td>
<td>476.985643</td>
<td>6.542142</td>
<td>6.886443</td>
<td>7988.852332</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>1.000000</td>
<td>-2.000000</td>
<td>86.600000</td>
<td>141.100000</td>
<td>60.300000</td>
<td>47.800000</td>
<td>1488.000000</td>
<td>61.000000</td>
<td>2.540000</td>
<td>2.070000</td>
<td>7.000000</td>
<td>48.000000</td>
<td>4150.000000</td>
<td>13.000000</td>
<td>16.000000</td>
<td>5118.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>52.000000</td>
<td>0.000000</td>
<td>94.500000</td>
<td>166.300000</td>
<td>64.100000</td>
<td>52.000000</td>
<td>2145.000000</td>
<td>97.000000</td>
<td>3.150000</td>
<td>3.110000</td>
<td>8.600000</td>
<td>70.000000</td>
<td>4800.000000</td>
<td>19.000000</td>
<td>25.000000</td>
<td>7788.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>103.000000</td>
<td>1.000000</td>
<td>97.000000</td>
<td>173.200000</td>
<td>65.500000</td>
<td>54.100000</td>
<td>2414.000000</td>
<td>120.000000</td>
<td>3.310000</td>
<td>3.290000</td>
<td>9.000000</td>
<td>95.000000</td>
<td>5200.000000</td>
<td>24.000000</td>
<td>30.000000</td>
<td>10295.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>154.000000</td>
<td>2.000000</td>
<td>102.400000</td>
<td>183.100000</td>
<td>66.900000</td>
<td>55.500000</td>
<td>2935.000000</td>
<td>141.000000</td>
<td>3.580000</td>
<td>3.410000</td>
<td>9.400000</td>
<td>116.000000</td>
<td>5500.000000</td>
<td>30.000000</td>
<td>34.000000</td>
<td>16503.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>205.000000</td>
<td>3.000000</td>
<td>120.900000</td>
<td>208.100000</td>
<td>72.300000</td>
<td>59.800000</td>
<td>4066.000000</td>
<td>326.000000</td>
<td>3.940000</td>
<td>4.170000</td>
<td>23.000000</td>
<td>288.000000</td>
<td>6600.000000</td>
<td>49.000000</td>
<td>54.000000</td>
<td>45400.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>(205, 26)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df.isnull()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">car_ID</th>
<th data-quarto-table-cell-role="th">symboling</th>
<th data-quarto-table-cell-role="th">CarName</th>
<th data-quarto-table-cell-role="th">fueltype</th>
<th data-quarto-table-cell-role="th">aspiration</th>
<th data-quarto-table-cell-role="th">doornumber</th>
<th data-quarto-table-cell-role="th">carbody</th>
<th data-quarto-table-cell-role="th">drivewheel</th>
<th data-quarto-table-cell-role="th">enginelocation</th>
<th data-quarto-table-cell-role="th">wheelbase</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">enginesize</th>
<th data-quarto-table-cell-role="th">fuelsystem</th>
<th data-quarto-table-cell-role="th">boreratio</th>
<th data-quarto-table-cell-role="th">stroke</th>
<th data-quarto-table-cell-role="th">compressionratio</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">peakrpm</th>
<th data-quarto-table-cell-role="th">citympg</th>
<th data-quarto-table-cell-role="th">highwaympg</th>
<th data-quarto-table-cell-role="th">price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">200</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">201</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">202</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">203</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">204</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>205 rows × 26 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df.isnull(),yticklabels<span class="op">=</span><span class="va">False</span>,cbar<span class="op">=</span><span class="va">False</span>,cmap<span class="op">=</span><span class="st">'viridis'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-9-output-2.png" width="540" height="513"></p>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df.dropna(inplace <span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>car_ID              0
symboling           0
CarName             0
fueltype            0
aspiration          0
doornumber          0
carbody             0
drivewheel          0
enginelocation      0
wheelbase           0
carlength           0
carwidth            0
carheight           0
curbweight          0
enginetype          0
cylindernumber      0
enginesize          0
fuelsystem          0
boreratio           0
stroke              0
compressionratio    0
horsepower          0
peakrpm             0
citympg             0
highwaympg          0
price               0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df.duplicated().<span class="bu">any</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df.describe(include<span class="op">=</span><span class="bu">object</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CarName</th>
<th data-quarto-table-cell-role="th">fueltype</th>
<th data-quarto-table-cell-role="th">aspiration</th>
<th data-quarto-table-cell-role="th">doornumber</th>
<th data-quarto-table-cell-role="th">carbody</th>
<th data-quarto-table-cell-role="th">drivewheel</th>
<th data-quarto-table-cell-role="th">enginelocation</th>
<th data-quarto-table-cell-role="th">enginetype</th>
<th data-quarto-table-cell-role="th">cylindernumber</th>
<th data-quarto-table-cell-role="th">fuelsystem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>205</td>
<td>205</td>
<td>205</td>
<td>205</td>
<td>205</td>
<td>205</td>
<td>205</td>
<td>205</td>
<td>205</td>
<td>205</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">unique</td>
<td>147</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>3</td>
<td>2</td>
<td>7</td>
<td>7</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">top</td>
<td>toyota corona</td>
<td>gas</td>
<td>std</td>
<td>four</td>
<td>sedan</td>
<td>fwd</td>
<td>front</td>
<td>ohc</td>
<td>four</td>
<td>mpfi</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">freq</td>
<td>6</td>
<td>185</td>
<td>168</td>
<td>115</td>
<td>96</td>
<td>120</td>
<td>202</td>
<td>148</td>
<td>159</td>
<td>94</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">car_ID</th>
<th data-quarto-table-cell-role="th">symboling</th>
<th data-quarto-table-cell-role="th">wheelbase</th>
<th data-quarto-table-cell-role="th">carlength</th>
<th data-quarto-table-cell-role="th">carwidth</th>
<th data-quarto-table-cell-role="th">carheight</th>
<th data-quarto-table-cell-role="th">curbweight</th>
<th data-quarto-table-cell-role="th">enginesize</th>
<th data-quarto-table-cell-role="th">boreratio</th>
<th data-quarto-table-cell-role="th">stroke</th>
<th data-quarto-table-cell-role="th">compressionratio</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">peakrpm</th>
<th data-quarto-table-cell-role="th">citympg</th>
<th data-quarto-table-cell-role="th">highwaympg</th>
<th data-quarto-table-cell-role="th">price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">car_ID</td>
<td>1.000000</td>
<td>-0.151621</td>
<td>0.129729</td>
<td>0.170636</td>
<td>0.052387</td>
<td>0.255960</td>
<td>0.071962</td>
<td>-0.033930</td>
<td>0.260064</td>
<td>-0.160824</td>
<td>0.150276</td>
<td>-0.015006</td>
<td>-0.203789</td>
<td>0.015940</td>
<td>0.011255</td>
<td>-0.109093</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">symboling</td>
<td>-0.151621</td>
<td>1.000000</td>
<td>-0.531954</td>
<td>-0.357612</td>
<td>-0.232919</td>
<td>-0.541038</td>
<td>-0.227691</td>
<td>-0.105790</td>
<td>-0.130051</td>
<td>-0.008735</td>
<td>-0.178515</td>
<td>0.070873</td>
<td>0.273606</td>
<td>-0.035823</td>
<td>0.034606</td>
<td>-0.079978</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">wheelbase</td>
<td>0.129729</td>
<td>-0.531954</td>
<td>1.000000</td>
<td>0.874587</td>
<td>0.795144</td>
<td>0.589435</td>
<td>0.776386</td>
<td>0.569329</td>
<td>0.488750</td>
<td>0.160959</td>
<td>0.249786</td>
<td>0.353294</td>
<td>-0.360469</td>
<td>-0.470414</td>
<td>-0.544082</td>
<td>0.577816</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">carlength</td>
<td>0.170636</td>
<td>-0.357612</td>
<td>0.874587</td>
<td>1.000000</td>
<td>0.841118</td>
<td>0.491029</td>
<td>0.877728</td>
<td>0.683360</td>
<td>0.606454</td>
<td>0.129533</td>
<td>0.158414</td>
<td>0.552623</td>
<td>-0.287242</td>
<td>-0.670909</td>
<td>-0.704662</td>
<td>0.682920</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">carwidth</td>
<td>0.052387</td>
<td>-0.232919</td>
<td>0.795144</td>
<td>0.841118</td>
<td>1.000000</td>
<td>0.279210</td>
<td>0.867032</td>
<td>0.735433</td>
<td>0.559150</td>
<td>0.182942</td>
<td>0.181129</td>
<td>0.640732</td>
<td>-0.220012</td>
<td>-0.642704</td>
<td>-0.677218</td>
<td>0.759325</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">carheight</td>
<td>0.255960</td>
<td>-0.541038</td>
<td>0.589435</td>
<td>0.491029</td>
<td>0.279210</td>
<td>1.000000</td>
<td>0.295572</td>
<td>0.067149</td>
<td>0.171071</td>
<td>-0.055307</td>
<td>0.261214</td>
<td>-0.108802</td>
<td>-0.320411</td>
<td>-0.048640</td>
<td>-0.107358</td>
<td>0.119336</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">curbweight</td>
<td>0.071962</td>
<td>-0.227691</td>
<td>0.776386</td>
<td>0.877728</td>
<td>0.867032</td>
<td>0.295572</td>
<td>1.000000</td>
<td>0.850594</td>
<td>0.648480</td>
<td>0.168790</td>
<td>0.151362</td>
<td>0.750739</td>
<td>-0.266243</td>
<td>-0.757414</td>
<td>-0.797465</td>
<td>0.835305</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">enginesize</td>
<td>-0.033930</td>
<td>-0.105790</td>
<td>0.569329</td>
<td>0.683360</td>
<td>0.735433</td>
<td>0.067149</td>
<td>0.850594</td>
<td>1.000000</td>
<td>0.583774</td>
<td>0.203129</td>
<td>0.028971</td>
<td>0.809769</td>
<td>-0.244660</td>
<td>-0.653658</td>
<td>-0.677470</td>
<td>0.874145</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">boreratio</td>
<td>0.260064</td>
<td>-0.130051</td>
<td>0.488750</td>
<td>0.606454</td>
<td>0.559150</td>
<td>0.171071</td>
<td>0.648480</td>
<td>0.583774</td>
<td>1.000000</td>
<td>-0.055909</td>
<td>0.005197</td>
<td>0.573677</td>
<td>-0.254976</td>
<td>-0.584532</td>
<td>-0.587012</td>
<td>0.553173</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">stroke</td>
<td>-0.160824</td>
<td>-0.008735</td>
<td>0.160959</td>
<td>0.129533</td>
<td>0.182942</td>
<td>-0.055307</td>
<td>0.168790</td>
<td>0.203129</td>
<td>-0.055909</td>
<td>1.000000</td>
<td>0.186110</td>
<td>0.080940</td>
<td>-0.067964</td>
<td>-0.042145</td>
<td>-0.043931</td>
<td>0.079443</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">compressionratio</td>
<td>0.150276</td>
<td>-0.178515</td>
<td>0.249786</td>
<td>0.158414</td>
<td>0.181129</td>
<td>0.261214</td>
<td>0.151362</td>
<td>0.028971</td>
<td>0.005197</td>
<td>0.186110</td>
<td>1.000000</td>
<td>-0.204326</td>
<td>-0.435741</td>
<td>0.324701</td>
<td>0.265201</td>
<td>0.067984</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">horsepower</td>
<td>-0.015006</td>
<td>0.070873</td>
<td>0.353294</td>
<td>0.552623</td>
<td>0.640732</td>
<td>-0.108802</td>
<td>0.750739</td>
<td>0.809769</td>
<td>0.573677</td>
<td>0.080940</td>
<td>-0.204326</td>
<td>1.000000</td>
<td>0.131073</td>
<td>-0.801456</td>
<td>-0.770544</td>
<td>0.808139</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">peakrpm</td>
<td>-0.203789</td>
<td>0.273606</td>
<td>-0.360469</td>
<td>-0.287242</td>
<td>-0.220012</td>
<td>-0.320411</td>
<td>-0.266243</td>
<td>-0.244660</td>
<td>-0.254976</td>
<td>-0.067964</td>
<td>-0.435741</td>
<td>0.131073</td>
<td>1.000000</td>
<td>-0.113544</td>
<td>-0.054275</td>
<td>-0.085267</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">citympg</td>
<td>0.015940</td>
<td>-0.035823</td>
<td>-0.470414</td>
<td>-0.670909</td>
<td>-0.642704</td>
<td>-0.048640</td>
<td>-0.757414</td>
<td>-0.653658</td>
<td>-0.584532</td>
<td>-0.042145</td>
<td>0.324701</td>
<td>-0.801456</td>
<td>-0.113544</td>
<td>1.000000</td>
<td>0.971337</td>
<td>-0.685751</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">highwaympg</td>
<td>0.011255</td>
<td>0.034606</td>
<td>-0.544082</td>
<td>-0.704662</td>
<td>-0.677218</td>
<td>-0.107358</td>
<td>-0.797465</td>
<td>-0.677470</td>
<td>-0.587012</td>
<td>-0.043931</td>
<td>0.265201</td>
<td>-0.770544</td>
<td>-0.054275</td>
<td>0.971337</td>
<td>1.000000</td>
<td>-0.697599</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">price</td>
<td>-0.109093</td>
<td>-0.079978</td>
<td>0.577816</td>
<td>0.682920</td>
<td>0.759325</td>
<td>0.119336</td>
<td>0.835305</td>
<td>0.874145</td>
<td>0.553173</td>
<td>0.079443</td>
<td>0.067984</td>
<td>0.808139</td>
<td>-0.085267</td>
<td>-0.685751</td>
<td>-0.697599</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df[[<span class="st">'carlength'</span>, <span class="st">'carwidth'</span>, <span class="st">'curbweight'</span>]].corr()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix,  cmap<span class="op">=</span><span class="st">'coolwarm'</span>, center<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix)):</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix)):</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        plt.text(j <span class="op">+</span> <span class="fl">0.5</span>, i <span class="op">+</span> <span class="fl">0.5</span>, <span class="ss">f"</span><span class="sc">{</span>correlation_matrix<span class="sc">.</span>iloc[i, j]<span class="sc">:.2f}</span><span class="ss">"</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Correlation Matrix'</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-14-output-1.png" width="609" height="505"></p>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop([<span class="st">'symboling'</span>, <span class="st">'car_ID'</span>, ], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   wheelbase  carlength  carwidth  carheight  curbweight  enginesize  \
0       88.6      168.8      64.1       48.8        2548         130   
1       88.6      168.8      64.1       48.8        2548         130   
2       94.5      171.2      65.5       52.4        2823         152   
3       99.8      176.6      66.2       54.3        2337         109   
4       99.4      176.6      66.4       54.3        2824         136   

   boreratio  stroke  compressionratio  horsepower  peakrpm  citympg  \
0       3.47    2.68               9.0         111     5000       21   
1       3.47    2.68               9.0         111     5000       21   
2       2.68    3.47               9.0         154     5000       19   
3       3.19    3.40              10.0         102     5500       24   
4       3.19    3.40               8.0         115     5500       18   

   highwaympg    price  
0          27  13495.0  
1          27  16500.0  
2          26  16500.0  
3          30  13950.0  
4          22  17450.0  </code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(205, 14)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>Index(['wheelbase', 'carlength', 'carwidth', 'carheight', 'curbweight',
       'enginesize', 'boreratio', 'stroke', 'compressionratio', 'horsepower',
       'peakrpm', 'citympg', 'highwaympg', 'price'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">'price'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'price'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>X.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">wheelbase</th>
<th data-quarto-table-cell-role="th">carlength</th>
<th data-quarto-table-cell-role="th">carwidth</th>
<th data-quarto-table-cell-role="th">carheight</th>
<th data-quarto-table-cell-role="th">curbweight</th>
<th data-quarto-table-cell-role="th">enginesize</th>
<th data-quarto-table-cell-role="th">boreratio</th>
<th data-quarto-table-cell-role="th">stroke</th>
<th data-quarto-table-cell-role="th">compressionratio</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">peakrpm</th>
<th data-quarto-table-cell-role="th">citympg</th>
<th data-quarto-table-cell-role="th">highwaympg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>88.6</td>
<td>168.8</td>
<td>64.1</td>
<td>48.8</td>
<td>2548</td>
<td>130</td>
<td>3.47</td>
<td>2.68</td>
<td>9.0</td>
<td>111</td>
<td>5000</td>
<td>21</td>
<td>27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>88.6</td>
<td>168.8</td>
<td>64.1</td>
<td>48.8</td>
<td>2548</td>
<td>130</td>
<td>3.47</td>
<td>2.68</td>
<td>9.0</td>
<td>111</td>
<td>5000</td>
<td>21</td>
<td>27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>94.5</td>
<td>171.2</td>
<td>65.5</td>
<td>52.4</td>
<td>2823</td>
<td>152</td>
<td>2.68</td>
<td>3.47</td>
<td>9.0</td>
<td>154</td>
<td>5000</td>
<td>19</td>
<td>26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>99.8</td>
<td>176.6</td>
<td>66.2</td>
<td>54.3</td>
<td>2337</td>
<td>109</td>
<td>3.19</td>
<td>3.40</td>
<td>10.0</td>
<td>102</td>
<td>5500</td>
<td>24</td>
<td>30</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>99.4</td>
<td>176.6</td>
<td>66.4</td>
<td>54.3</td>
<td>2824</td>
<td>136</td>
<td>3.19</td>
<td>3.40</td>
<td>8.0</td>
<td>115</td>
<td>5500</td>
<td>18</td>
<td>22</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>0      13495.0
1      16500.0
2      16500.0
3      13950.0
4      17450.0
        ...   
200    16845.0
201    19045.0
202    21485.0
203    22470.0
204    22625.0
Name: price, Length: 205, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df.corr(), cmap<span class="op">=</span><span class="st">'coolwarm'</span>, fmt<span class="op">=</span><span class="st">".2f"</span>, linewidths<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(df.corr())):</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(df.corr())):</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        plt.text(j <span class="op">+</span> <span class="fl">0.5</span>, i <span class="op">+</span> <span class="fl">0.5</span>, <span class="ss">f"</span><span class="sc">{</span>df<span class="sc">.</span>corr()<span class="sc">.</span>iloc[i, j]<span class="sc">:.2f}</span><span class="ss">"</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Correlation Heatmap'</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-21-output-1.png" width="722" height="607"></p>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-22-output-1.png" width="3298" height="3299"></p>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">'enginesize'</span>], kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Engine Size'</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-23-output-1.png" width="659" height="523"></p>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">'wheelbase'</span>], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Wheelbase'</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-24-output-1.png" width="659" height="523"></p>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">'carlength'</span>], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Car Length'</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-25-output-1.png" width="660" height="523"></p>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">'carlength'</span>], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Car Length'</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-26-output-1.png" width="660" height="523"></p>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">'carheight'</span>], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Car Height'</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-27-output-1.png" width="659" height="523"></p>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">'curbweight'</span>], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Curb Weight'</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-28-output-1.png" width="659" height="523"></p>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plt.scatter(df[<span class="st">'enginesize'</span>], df[<span class="st">'price'</span>])</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Engine Size'</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Price'</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter Plot between Engine Size and Price'</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-29-output-1.png" width="610" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'horsepower'</span>, y<span class="op">=</span><span class="st">'price'</span>, data<span class="op">=</span>df)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Horsepower vs. Price (Scatter Plot)'</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-30-output-1.png" width="623" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">'price'</span>], kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Car Prices with KDE'</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-31-output-1.png" width="585" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">'citympg'</span>], kde<span class="op">=</span><span class="va">True</span>, bins<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of City MPG'</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'City MPG'</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-32-output-1.png" width="585" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>X_train,X_test,y_train,y_test<span class="op">=</span>train_test_split(X,y,test_size<span class="op">=</span><span class="fl">0.25</span>,random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">'wheelbase'</span>, y<span class="op">=</span><span class="st">'price'</span>, data<span class="op">=</span>df, scatter_kws<span class="op">=</span>{<span class="st">'s'</span>: <span class="dv">20</span>}, line_kws<span class="op">=</span>{<span class="st">'color'</span>: <span class="st">'red'</span>})</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Wheelbase vs. Price'</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Wheelbase'</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Price'</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-34-output-1.png" width="610" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">'carlength'</span>, y<span class="op">=</span><span class="st">'price'</span>, data<span class="op">=</span>df, scatter_kws<span class="op">=</span>{<span class="st">'s'</span>: <span class="dv">20</span>}, line_kws<span class="op">=</span>{<span class="st">'color'</span>: <span class="st">'red'</span>})</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Car Length vs. Price'</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Car Length'</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Price'</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-35-output-1.png" width="612" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">'curbweight'</span>, y<span class="op">=</span><span class="st">'price'</span>, data<span class="op">=</span>df, scatter_kws<span class="op">=</span>{<span class="st">'s'</span>: <span class="dv">20</span>}, line_kws<span class="op">=</span>{<span class="st">'color'</span>: <span class="st">'red'</span>})</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Curb Weight vs. Price'</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Curb Weight'</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Price'</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-36-output-1.png" width="610" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">'enginesize'</span>, y<span class="op">=</span><span class="st">'price'</span>, data<span class="op">=</span>df, scatter_kws<span class="op">=</span>{<span class="st">'s'</span>: <span class="dv">20</span>}, line_kws<span class="op">=</span>{<span class="st">'color'</span>: <span class="st">'red'</span>})</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Engine Size vs. Price'</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Engine Size'</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Price'</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-37-output-1.png" width="610" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">'horsepower'</span>, y<span class="op">=</span><span class="st">'price'</span>, data<span class="op">=</span>df, scatter_kws<span class="op">=</span>{<span class="st">'s'</span>: <span class="dv">20</span>}, line_kws<span class="op">=</span>{<span class="st">'color'</span>: <span class="st">'red'</span>})</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Horsepower vs. Price'</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Horsepower'</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Price'</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-38-output-1.png" width="623" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">'citympg'</span>, y<span class="op">=</span><span class="st">'price'</span>, data<span class="op">=</span>df, scatter_kws<span class="op">=</span>{<span class="st">'s'</span>: <span class="dv">20</span>}, line_kws<span class="op">=</span>{<span class="st">'color'</span>: <span class="st">'red'</span>})</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'City MPG vs. Price'</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'City MPG'</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Price'</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-39-output-1.png" width="621" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['wheelbase', 'carlength', 'carwidth', 'carheight', 'curbweight',
       'enginesize', 'boreratio', 'stroke', 'compressionratio', 'horsepower',
       'peakrpm', 'citympg', 'highwaympg'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> [<span class="st">'enginesize'</span>, <span class="st">'horsepower'</span>, <span class="st">'peakrpm'</span>]</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>X_train_encoded <span class="op">=</span> pd.get_dummies(X_train, columns<span class="op">=</span>categorical_cols)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>X_test_encoded <span class="op">=</span> pd.get_dummies(X_test, columns<span class="op">=</span>categorical_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> X_train.columns:</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    unique_values <span class="op">=</span> X_train[column].nunique()</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Column '</span><span class="sc">{</span>column<span class="sc">}</span><span class="ss">' has </span><span class="sc">{</span>unique_values<span class="sc">}</span><span class="ss"> unique values."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Column 'wheelbase' has 46 unique values.
Column 'carlength' has 63 unique values.
Column 'carwidth' has 41 unique values.
Column 'carheight' has 47 unique values.
Column 'curbweight' has 132 unique values.
Column 'enginesize' has 41 unique values.
Column 'boreratio' has 36 unique values.
Column 'stroke' has 35 unique values.
Column 'compressionratio' has 30 unique values.
Column 'horsepower' has 53 unique values.
Column 'peakrpm' has 23 unique values.
Column 'citympg' has 27 unique values.
Column 'highwaympg' has 28 unique values.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>regression<span class="op">=</span>LinearRegression()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_cols:</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Unique values in '</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">': </span><span class="sc">{</span>X_train[col]<span class="sc">.</span>unique()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique values in 'enginesize': [103 122  97 136 146  70 194  92 108 181 140 110 164 151  98 121  91 120
 156  90 141 134 152 119 130  79 109 183 145 258 111 326 161 131 132 209
 234 171  80 203 304]
Unique values in 'horsepower': [ 55  92  69 110 116 101 207  68  82 160 175  73  76 121 143 100  70  95
 112 145 102 114 142 154  90  88  84 162 115  60  97  62 111  52  85 123
 106  86 176  56  78 200 262 156 140 182 155  64 135 288 152 184 161]
Unique values in 'peakrpm': [4800 4200 5200 5500 6000 5900 5000 4500 4250 4400 6600 5800 5400 5600
 4900 4150 5250 5100 4350 4750 4650 5300 5750]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train.dtypes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>wheelbase           float64
carlength           float64
carwidth            float64
carheight           float64
curbweight            int64
enginesize            int64
boreratio           float64
stroke              float64
compressionratio    float64
horsepower            int64
peakrpm               int64
citympg               int64
highwaympg            int64
dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>X_train_encoded <span class="op">=</span> pd.get_dummies(X_train, columns<span class="op">=</span>categorical_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>X_train_encoded <span class="op">=</span> pd.get_dummies(X_train, columns<span class="op">=</span>categorical_cols)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>X_test_encoded <span class="op">=</span> pd.get_dummies(X_test, columns<span class="op">=</span>categorical_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>non_numeric_cols_train <span class="op">=</span> X_train_encoded.select_dtypes(exclude<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>]).columns</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>non_numeric_cols_test <span class="op">=</span> X_test_encoded.select_dtypes(exclude<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>]).columns</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Non-numeric columns in X_train_encoded:"</span>, non_numeric_cols_train)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Non-numeric columns in X_test_encoded:"</span>, non_numeric_cols_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-numeric columns in X_train_encoded: Index(['enginesize_70', 'enginesize_79', 'enginesize_80', 'enginesize_90',
       'enginesize_91', 'enginesize_92', 'enginesize_97', 'enginesize_98',
       'enginesize_103', 'enginesize_108',
       ...
       'peakrpm_5250', 'peakrpm_5300', 'peakrpm_5400', 'peakrpm_5500',
       'peakrpm_5600', 'peakrpm_5750', 'peakrpm_5800', 'peakrpm_5900',
       'peakrpm_6000', 'peakrpm_6600'],
      dtype='object', length=117)
Non-numeric columns in X_test_encoded: Index(['enginesize_61', 'enginesize_70', 'enginesize_90', 'enginesize_92',
       'enginesize_97', 'enginesize_98', 'enginesize_108', 'enginesize_110',
       'enginesize_120', 'enginesize_121', 'enginesize_122', 'enginesize_131',
       'enginesize_134', 'enginesize_136', 'enginesize_140', 'enginesize_141',
       'enginesize_146', 'enginesize_152', 'enginesize_156', 'enginesize_171',
       'enginesize_173', 'enginesize_181', 'enginesize_183', 'enginesize_209',
       'enginesize_308', 'horsepower_48', 'horsepower_52', 'horsepower_56',
       'horsepower_58', 'horsepower_62', 'horsepower_68', 'horsepower_69',
       'horsepower_70', 'horsepower_72', 'horsepower_73', 'horsepower_82',
       'horsepower_84', 'horsepower_86', 'horsepower_88', 'horsepower_92',
       'horsepower_94', 'horsepower_95', 'horsepower_97', 'horsepower_101',
       'horsepower_102', 'horsepower_110', 'horsepower_111', 'horsepower_114',
       'horsepower_116', 'horsepower_120', 'horsepower_123', 'horsepower_134',
       'horsepower_145', 'horsepower_152', 'horsepower_160', 'horsepower_161',
       'horsepower_182', 'horsepower_184', 'peakrpm_4150', 'peakrpm_4200',
       'peakrpm_4350', 'peakrpm_4400', 'peakrpm_4500', 'peakrpm_4800',
       'peakrpm_5000', 'peakrpm_5100', 'peakrpm_5200', 'peakrpm_5250',
       'peakrpm_5400', 'peakrpm_5500', 'peakrpm_5800', 'peakrpm_6000'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>label_encoder_train <span class="op">=</span> LabelEncoder()</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> non_numeric_cols_train:</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    X_train_encoded[col] <span class="op">=</span> label_encoder_train.fit_transform(X_train_encoded[col])</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>label_encoder_test <span class="op">=</span> LabelEncoder()</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> non_numeric_cols_test:</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    X_test_encoded[col] <span class="op">=</span> label_encoder_test.fit_transform(X_test_encoded[col])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> non_numeric_cols_train:</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Unique values in </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>X_train_encoded[col]<span class="sc">.</span>unique()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique values in enginesize_70: [0 1]
Unique values in enginesize_79: [0 1]
Unique values in enginesize_80: [0 1]
Unique values in enginesize_90: [0 1]
Unique values in enginesize_91: [0 1]
Unique values in enginesize_92: [0 1]
Unique values in enginesize_97: [0 1]
Unique values in enginesize_98: [0 1]
Unique values in enginesize_103: [1 0]
Unique values in enginesize_108: [0 1]
Unique values in enginesize_109: [0 1]
Unique values in enginesize_110: [0 1]
Unique values in enginesize_111: [0 1]
Unique values in enginesize_119: [0 1]
Unique values in enginesize_120: [0 1]
Unique values in enginesize_121: [0 1]
Unique values in enginesize_122: [0 1]
Unique values in enginesize_130: [0 1]
Unique values in enginesize_131: [0 1]
Unique values in enginesize_132: [0 1]
Unique values in enginesize_134: [0 1]
Unique values in enginesize_136: [0 1]
Unique values in enginesize_140: [0 1]
Unique values in enginesize_141: [0 1]
Unique values in enginesize_145: [0 1]
Unique values in enginesize_146: [0 1]
Unique values in enginesize_151: [0 1]
Unique values in enginesize_152: [0 1]
Unique values in enginesize_156: [0 1]
Unique values in enginesize_161: [0 1]
Unique values in enginesize_164: [0 1]
Unique values in enginesize_171: [0 1]
Unique values in enginesize_181: [0 1]
Unique values in enginesize_183: [0 1]
Unique values in enginesize_194: [0 1]
Unique values in enginesize_203: [0 1]
Unique values in enginesize_209: [0 1]
Unique values in enginesize_234: [0 1]
Unique values in enginesize_258: [0 1]
Unique values in enginesize_304: [0 1]
Unique values in enginesize_326: [0 1]
Unique values in horsepower_52: [0 1]
Unique values in horsepower_55: [1 0]
Unique values in horsepower_56: [0 1]
Unique values in horsepower_60: [0 1]
Unique values in horsepower_62: [0 1]
Unique values in horsepower_64: [0 1]
Unique values in horsepower_68: [0 1]
Unique values in horsepower_69: [0 1]
Unique values in horsepower_70: [0 1]
Unique values in horsepower_73: [0 1]
Unique values in horsepower_76: [0 1]
Unique values in horsepower_78: [0 1]
Unique values in horsepower_82: [0 1]
Unique values in horsepower_84: [0 1]
Unique values in horsepower_85: [0 1]
Unique values in horsepower_86: [0 1]
Unique values in horsepower_88: [0 1]
Unique values in horsepower_90: [0 1]
Unique values in horsepower_92: [0 1]
Unique values in horsepower_95: [0 1]
Unique values in horsepower_97: [0 1]
Unique values in horsepower_100: [0 1]
Unique values in horsepower_101: [0 1]
Unique values in horsepower_102: [0 1]
Unique values in horsepower_106: [0 1]
Unique values in horsepower_110: [0 1]
Unique values in horsepower_111: [0 1]
Unique values in horsepower_112: [0 1]
Unique values in horsepower_114: [0 1]
Unique values in horsepower_115: [0 1]
Unique values in horsepower_116: [0 1]
Unique values in horsepower_121: [0 1]
Unique values in horsepower_123: [0 1]
Unique values in horsepower_135: [0 1]
Unique values in horsepower_140: [0 1]
Unique values in horsepower_142: [0 1]
Unique values in horsepower_143: [0 1]
Unique values in horsepower_145: [0 1]
Unique values in horsepower_152: [0 1]
Unique values in horsepower_154: [0 1]
Unique values in horsepower_155: [0 1]
Unique values in horsepower_156: [0 1]
Unique values in horsepower_160: [0 1]
Unique values in horsepower_161: [0 1]
Unique values in horsepower_162: [0 1]
Unique values in horsepower_175: [0 1]
Unique values in horsepower_176: [0 1]
Unique values in horsepower_182: [0 1]
Unique values in horsepower_184: [0 1]
Unique values in horsepower_200: [0 1]
Unique values in horsepower_207: [0 1]
Unique values in horsepower_262: [0 1]
Unique values in horsepower_288: [0 1]
Unique values in peakrpm_4150: [0 1]
Unique values in peakrpm_4200: [0 1]
Unique values in peakrpm_4250: [0 1]
Unique values in peakrpm_4350: [0 1]
Unique values in peakrpm_4400: [0 1]
Unique values in peakrpm_4500: [0 1]
Unique values in peakrpm_4650: [0 1]
Unique values in peakrpm_4750: [0 1]
Unique values in peakrpm_4800: [1 0]
Unique values in peakrpm_4900: [0 1]
Unique values in peakrpm_5000: [0 1]
Unique values in peakrpm_5100: [0 1]
Unique values in peakrpm_5200: [0 1]
Unique values in peakrpm_5250: [0 1]
Unique values in peakrpm_5300: [0 1]
Unique values in peakrpm_5400: [0 1]
Unique values in peakrpm_5500: [0 1]
Unique values in peakrpm_5600: [0 1]
Unique values in peakrpm_5750: [0 1]
Unique values in peakrpm_5800: [0 1]
Unique values in peakrpm_5900: [0 1]
Unique values in peakrpm_6000: [0 1]
Unique values in peakrpm_6600: [0 1]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> non_numeric_cols_test:</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Unique values in </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>X_test_encoded[col]<span class="sc">.</span>unique()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique values in enginesize_61: [0 1]
Unique values in enginesize_70: [0 1]
Unique values in enginesize_90: [0 1]
Unique values in enginesize_92: [0 1]
Unique values in enginesize_97: [0 1]
Unique values in enginesize_98: [0 1]
Unique values in enginesize_108: [0 1]
Unique values in enginesize_110: [0 1]
Unique values in enginesize_120: [0 1]
Unique values in enginesize_121: [0 1]
Unique values in enginesize_122: [0 1]
Unique values in enginesize_131: [0 1]
Unique values in enginesize_134: [0 1]
Unique values in enginesize_136: [0 1]
Unique values in enginesize_140: [0 1]
Unique values in enginesize_141: [0 1]
Unique values in enginesize_146: [0 1]
Unique values in enginesize_152: [0 1]
Unique values in enginesize_156: [0 1]
Unique values in enginesize_171: [0 1]
Unique values in enginesize_173: [0 1]
Unique values in enginesize_181: [0 1]
Unique values in enginesize_183: [0 1]
Unique values in enginesize_209: [1 0]
Unique values in enginesize_308: [0 1]
Unique values in horsepower_48: [0 1]
Unique values in horsepower_52: [0 1]
Unique values in horsepower_56: [0 1]
Unique values in horsepower_58: [0 1]
Unique values in horsepower_62: [0 1]
Unique values in horsepower_68: [0 1]
Unique values in horsepower_69: [0 1]
Unique values in horsepower_70: [0 1]
Unique values in horsepower_72: [0 1]
Unique values in horsepower_73: [0 1]
Unique values in horsepower_82: [0 1]
Unique values in horsepower_84: [0 1]
Unique values in horsepower_86: [0 1]
Unique values in horsepower_88: [0 1]
Unique values in horsepower_92: [0 1]
Unique values in horsepower_94: [0 1]
Unique values in horsepower_95: [0 1]
Unique values in horsepower_97: [0 1]
Unique values in horsepower_101: [0 1]
Unique values in horsepower_102: [0 1]
Unique values in horsepower_110: [0 1]
Unique values in horsepower_111: [0 1]
Unique values in horsepower_114: [0 1]
Unique values in horsepower_116: [0 1]
Unique values in horsepower_120: [0 1]
Unique values in horsepower_123: [0 1]
Unique values in horsepower_134: [0 1]
Unique values in horsepower_145: [0 1]
Unique values in horsepower_152: [0 1]
Unique values in horsepower_160: [0 1]
Unique values in horsepower_161: [0 1]
Unique values in horsepower_182: [1 0]
Unique values in horsepower_184: [0 1]
Unique values in peakrpm_4150: [0 1]
Unique values in peakrpm_4200: [0 1]
Unique values in peakrpm_4350: [0 1]
Unique values in peakrpm_4400: [0 1]
Unique values in peakrpm_4500: [0 1]
Unique values in peakrpm_4800: [0 1]
Unique values in peakrpm_5000: [0 1]
Unique values in peakrpm_5100: [0 1]
Unique values in peakrpm_5200: [0 1]
Unique values in peakrpm_5250: [0 1]
Unique values in peakrpm_5400: [1 0]
Unique values in peakrpm_5500: [0 1]
Unique values in peakrpm_5800: [0 1]
Unique values in peakrpm_6000: [0 1]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder, OneHotEncoder</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>label_encoder <span class="op">=</span> LabelEncoder()</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_cols:</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    X_train[col] <span class="op">=</span> label_encoder.fit_transform(X_train[col])</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>onehot_encoder <span class="op">=</span> OneHotEncoder(drop<span class="op">=</span><span class="st">'first'</span>, sparse<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>X_train_encoded <span class="op">=</span> pd.get_dummies(X_train, columns<span class="op">=</span>categorical_cols, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>X_test_encoded <span class="op">=</span> pd.get_dummies(X_test, columns<span class="op">=</span>categorical_cols, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>X_train_encoded, X_test_encoded <span class="op">=</span> X_train_encoded.align(X_test_encoded, join<span class="op">=</span><span class="st">'outer'</span>, axis<span class="op">=</span><span class="dv">1</span>, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>regression.fit(X_train_encoded, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>validation_score<span class="op">=</span>cross_val_score(regression,X_train,y_train,scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                             cv<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>np.mean(validation_score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>-17619779.964257453</code></pre>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> regression.predict(X_test_encoded)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>y_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>array([ 17663.40920114,   2843.49700864,   -681.0197125 ,  20031.97260338,
        23256.22526061,  -2078.06829731,  11404.65164046,   8303.95517846,
        34989.85861164,  -1974.8074486 ,    672.29083674,   7942.30385746,
        26485.26793673,  -1324.44214526,  31219.07729321,   3691.87875078,
        -5254.23835884,   -389.77808369,   1982.84977136,  34302.79230783,
         4217.87918551,  15554.97366416,  -1635.32099728, -14421.58919858,
        -3894.410904  ,  18993.50244592,  10010.82968533,  28157.3938917 ,
        -2754.23702629,  27383.42715415,  21693.84435239,  -4089.13068506,
         3223.28302425,  32429.56926617,  -6839.56578167,  21720.24707413,
        34377.53936716,   9197.98033432,    136.89843489,    723.50606337,
        32982.56263849,  11575.29609297,  49483.4797775 ,   3077.1128973 ,
        -2818.66172925,  -8107.23857484,  -4089.13068506,  32626.79986009,
        25793.48112021,  -1219.70262027,   -172.88303499,   8578.30732609])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_error,mean_squared_error</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>mse<span class="op">=</span>mean_squared_error(y_test,y_pred)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>mae<span class="op">=</span>mean_absolute_error(y_test,y_pred)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>rmse<span class="op">=</span>np.sqrt(mse)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mse)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mae)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rmse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>177304634.11961922
11133.618219594775
13315.57862503989</code></pre>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>score<span class="op">=</span>r2_score(y_test,y_pred)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(score)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">1</span> <span class="op">-</span> (<span class="dv">1</span><span class="op">-</span>score)<span class="op">*</span>(<span class="bu">len</span>(y_test)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(<span class="bu">len</span>(y_test)<span class="op">-</span>X_test.shape[<span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-1.6205416455966546
-2.51704273487972</code></pre>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>plt.scatter(y_test,y_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>&lt;matplotlib.collections.PathCollection at 0x1eb154bed10&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-58-output-2.png" width="603" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>residuals<span class="op">=</span>y_test<span class="op">-</span>y_pred</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>15     13096.590799
9      15015.669991
100    10230.019713
132    -8181.972603
68      4991.774739
95      9877.068297
159    -3616.651640
162      954.044822
147   -24791.858612
182     9749.807449
191    12622.709163
164      295.696143
65     -8205.267937
175    11312.442145
73      9740.922707
152     2796.121249
18     10405.238359
82     13018.778084
86      6206.150229
143   -24342.792308
60      4277.120814
101    -2055.973664
98      9884.320997
30     20900.589199
25     10586.410904
16     22321.497554
168     -371.829685
195   -14742.393892
97     10753.237026
194   -14443.427154
67      3858.155648
120    10318.130685
154     4674.716976
202   -10944.569266
79     14528.565782
69      6455.752926
145   -23118.539367
55      1747.019666
45      8779.601565
84     13765.493937
146   -25519.562638
66      6768.703907
111   -33903.479777
153     3840.887103
96     10317.661729
38     17202.238575
24     10318.130685
139   -25573.799860
112    -8893.481120
29     14183.702620
19      6467.883035
178     7979.692674
Name: price, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>sns.displot(residuals,kind<span class="op">=</span><span class="st">'kde'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-60-output-1.png" width="471" height="470"></p>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>plt.scatter(y_pred,residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>&lt;matplotlib.collections.PathCollection at 0x1eb13db5510&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-61-output-2.png" width="604" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(y_pred, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Predicted Prices'</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Predicted Prices'</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-62-output-1.png" width="586" height="449"></p>
</div>
</div>
<h3 class="anchored">3.b)Non-Linear Regression</h3>
    <h3 class="anchored">What is a Non-Linear Regression?</h3>
    <p>Non-Linear regression is a type of polynomial regression. It is a method to model a non-linear relationship between the dependent and independent variables. It is used in place when the data shows a curvy trend and linear regression would not produce
        very accurate results when compared to non-linear regression. This is because in linear regression it is pre-assumed that the data is linear. </p>
    <h3 class="anchored">How does a Non-Linear Regression work?</h3>
    <p>observe closely then we will realize that to evolve from linear regression to non-linear regression. We are just supposed to add the higher-order terms of the dependent features in the feature space. This is sometimes also known as feature engineering
        but not exactly.</p>
    <h3 class="anchored">Applications of Non-Linear Regression</h3>
    <p> that most of the real-world data is non-linear and hence non-linear regression techniques are far better than linear regression techniques. Non-Linear regression techniques help to get a robust model whose predictions are reliable and as per the trend
        followed by the data in history. Tasks related to exponential growth or decay of a population, financial forecasting, and logistic pricing model were all successfully accomplished by the Non-Linear Regression techniques.</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> GradientBoostingRegressor</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_error</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'miami-housing.csv'</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LATITUDE</th>
<th data-quarto-table-cell-role="th">LONGITUDE</th>
<th data-quarto-table-cell-role="th">PARCELNO</th>
<th data-quarto-table-cell-role="th">SALE_PRC</th>
<th data-quarto-table-cell-role="th">LND_SQFOOT</th>
<th data-quarto-table-cell-role="th">TOT_LVG_AREA</th>
<th data-quarto-table-cell-role="th">SPEC_FEAT_VAL</th>
<th data-quarto-table-cell-role="th">RAIL_DIST</th>
<th data-quarto-table-cell-role="th">OCEAN_DIST</th>
<th data-quarto-table-cell-role="th">WATER_DIST</th>
<th data-quarto-table-cell-role="th">CNTR_DIST</th>
<th data-quarto-table-cell-role="th">SUBCNTR_DI</th>
<th data-quarto-table-cell-role="th">HWY_DIST</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">avno60plus</th>
<th data-quarto-table-cell-role="th">month_sold</th>
<th data-quarto-table-cell-role="th">structure_quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25.891031</td>
<td>-80.160561</td>
<td>622280070620</td>
<td>440000.0</td>
<td>9375</td>
<td>1753</td>
<td>0</td>
<td>2815.9</td>
<td>12811.4</td>
<td>347.6</td>
<td>42815.3</td>
<td>37742.2</td>
<td>15954.9</td>
<td>67</td>
<td>0</td>
<td>8</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>25.891324</td>
<td>-80.153968</td>
<td>622280100460</td>
<td>349000.0</td>
<td>9375</td>
<td>1715</td>
<td>0</td>
<td>4359.1</td>
<td>10648.4</td>
<td>337.8</td>
<td>43504.9</td>
<td>37340.5</td>
<td>18125.0</td>
<td>63</td>
<td>0</td>
<td>9</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>25.891334</td>
<td>-80.153740</td>
<td>622280100470</td>
<td>800000.0</td>
<td>9375</td>
<td>2276</td>
<td>49206</td>
<td>4412.9</td>
<td>10574.1</td>
<td>297.1</td>
<td>43530.4</td>
<td>37328.7</td>
<td>18200.5</td>
<td>61</td>
<td>0</td>
<td>2</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>25.891765</td>
<td>-80.152657</td>
<td>622280100530</td>
<td>988000.0</td>
<td>12450</td>
<td>2058</td>
<td>10033</td>
<td>4585.0</td>
<td>10156.5</td>
<td>0.0</td>
<td>43797.5</td>
<td>37423.2</td>
<td>18514.4</td>
<td>63</td>
<td>0</td>
<td>9</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>25.891825</td>
<td>-80.154639</td>
<td>622280100200</td>
<td>755000.0</td>
<td>12800</td>
<td>1684</td>
<td>16681</td>
<td>4063.4</td>
<td>10836.8</td>
<td>326.6</td>
<td>43599.7</td>
<td>37550.8</td>
<td>17903.4</td>
<td>42</td>
<td>0</td>
<td>7</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>Index(['LATITUDE', 'LONGITUDE', 'PARCELNO', 'SALE_PRC', 'LND_SQFOOT',
       'TOT_LVG_AREA', 'SPEC_FEAT_VAL', 'RAIL_DIST', 'OCEAN_DIST',
       'WATER_DIST', 'CNTR_DIST', 'SUBCNTR_DI', 'HWY_DIST', 'age',
       'avno60plus', 'month_sold', 'structure_quality'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 13932 entries, 0 to 13931
Data columns (total 17 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   LATITUDE           13932 non-null  float64
 1   LONGITUDE          13932 non-null  float64
 2   PARCELNO           13932 non-null  int64  
 3   SALE_PRC           13932 non-null  float64
 4   LND_SQFOOT         13932 non-null  int64  
 5   TOT_LVG_AREA       13932 non-null  int64  
 6   SPEC_FEAT_VAL      13932 non-null  int64  
 7   RAIL_DIST          13932 non-null  float64
 8   OCEAN_DIST         13932 non-null  float64
 9   WATER_DIST         13932 non-null  float64
 10  CNTR_DIST          13932 non-null  float64
 11  SUBCNTR_DI         13932 non-null  float64
 12  HWY_DIST           13932 non-null  float64
 13  age                13932 non-null  int64  
 14  avno60plus         13932 non-null  int64  
 15  month_sold         13932 non-null  int64  
 16  structure_quality  13932 non-null  int64  
dtypes: float64(9), int64(8)
memory usage: 1.8 MB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LATITUDE</th>
<th data-quarto-table-cell-role="th">LONGITUDE</th>
<th data-quarto-table-cell-role="th">PARCELNO</th>
<th data-quarto-table-cell-role="th">SALE_PRC</th>
<th data-quarto-table-cell-role="th">LND_SQFOOT</th>
<th data-quarto-table-cell-role="th">TOT_LVG_AREA</th>
<th data-quarto-table-cell-role="th">SPEC_FEAT_VAL</th>
<th data-quarto-table-cell-role="th">RAIL_DIST</th>
<th data-quarto-table-cell-role="th">OCEAN_DIST</th>
<th data-quarto-table-cell-role="th">WATER_DIST</th>
<th data-quarto-table-cell-role="th">CNTR_DIST</th>
<th data-quarto-table-cell-role="th">SUBCNTR_DI</th>
<th data-quarto-table-cell-role="th">HWY_DIST</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">avno60plus</th>
<th data-quarto-table-cell-role="th">month_sold</th>
<th data-quarto-table-cell-role="th">structure_quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>1.393200e+04</td>
<td>1.393200e+04</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>13932.000000</td>
<td>13932.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>25.728811</td>
<td>-80.327475</td>
<td>2.356496e+12</td>
<td>3.999419e+05</td>
<td>8620.879917</td>
<td>2058.044574</td>
<td>9562.493468</td>
<td>8348.548715</td>
<td>31690.993798</td>
<td>11960.285235</td>
<td>68490.327132</td>
<td>41115.047265</td>
<td>7723.770693</td>
<td>30.669251</td>
<td>0.014930</td>
<td>6.655828</td>
<td>3.513997</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.140633</td>
<td>0.089199</td>
<td>1.199290e+12</td>
<td>3.172147e+05</td>
<td>6070.088742</td>
<td>813.538535</td>
<td>13890.967782</td>
<td>6178.027333</td>
<td>17595.079468</td>
<td>11932.992369</td>
<td>32008.474808</td>
<td>22161.825935</td>
<td>6068.936108</td>
<td>21.153068</td>
<td>0.121276</td>
<td>3.301523</td>
<td>1.097444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>25.434333</td>
<td>-80.542172</td>
<td>1.020008e+11</td>
<td>7.200000e+04</td>
<td>1248.000000</td>
<td>854.000000</td>
<td>0.000000</td>
<td>10.500000</td>
<td>236.100000</td>
<td>0.000000</td>
<td>3825.600000</td>
<td>1462.800000</td>
<td>90.200000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>25.620056</td>
<td>-80.403278</td>
<td>1.079160e+12</td>
<td>2.350000e+05</td>
<td>5400.000000</td>
<td>1470.000000</td>
<td>810.000000</td>
<td>3299.450000</td>
<td>18079.350000</td>
<td>2675.850000</td>
<td>42823.100000</td>
<td>23996.250000</td>
<td>2998.125000</td>
<td>14.000000</td>
<td>0.000000</td>
<td>4.000000</td>
<td>2.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>25.731810</td>
<td>-80.338911</td>
<td>3.040300e+12</td>
<td>3.100000e+05</td>
<td>7500.000000</td>
<td>1877.500000</td>
<td>2765.500000</td>
<td>7106.300000</td>
<td>28541.750000</td>
<td>6922.600000</td>
<td>65852.400000</td>
<td>41109.900000</td>
<td>6159.750000</td>
<td>26.000000</td>
<td>0.000000</td>
<td>7.000000</td>
<td>4.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>25.852269</td>
<td>-80.258019</td>
<td>3.060170e+12</td>
<td>4.280000e+05</td>
<td>9126.250000</td>
<td>2471.000000</td>
<td>12352.250000</td>
<td>12102.600000</td>
<td>44310.650000</td>
<td>19200.000000</td>
<td>89358.325000</td>
<td>53949.375000</td>
<td>10854.200000</td>
<td>46.000000</td>
<td>0.000000</td>
<td>9.000000</td>
<td>4.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>25.974382</td>
<td>-80.119746</td>
<td>3.660170e+12</td>
<td>2.650000e+06</td>
<td>57064.000000</td>
<td>6287.000000</td>
<td>175020.000000</td>
<td>29621.500000</td>
<td>75744.900000</td>
<td>50399.800000</td>
<td>159976.500000</td>
<td>110553.800000</td>
<td>48167.300000</td>
<td>96.000000</td>
<td>1.000000</td>
<td>12.000000</td>
<td>5.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>(13932, 17)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>df.isnull()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LATITUDE</th>
<th data-quarto-table-cell-role="th">LONGITUDE</th>
<th data-quarto-table-cell-role="th">PARCELNO</th>
<th data-quarto-table-cell-role="th">SALE_PRC</th>
<th data-quarto-table-cell-role="th">LND_SQFOOT</th>
<th data-quarto-table-cell-role="th">TOT_LVG_AREA</th>
<th data-quarto-table-cell-role="th">SPEC_FEAT_VAL</th>
<th data-quarto-table-cell-role="th">RAIL_DIST</th>
<th data-quarto-table-cell-role="th">OCEAN_DIST</th>
<th data-quarto-table-cell-role="th">WATER_DIST</th>
<th data-quarto-table-cell-role="th">CNTR_DIST</th>
<th data-quarto-table-cell-role="th">SUBCNTR_DI</th>
<th data-quarto-table-cell-role="th">HWY_DIST</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">avno60plus</th>
<th data-quarto-table-cell-role="th">month_sold</th>
<th data-quarto-table-cell-role="th">structure_quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13927</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13928</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13929</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13930</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13931</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>13932 rows × 17 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>df.dropna(inplace <span class="op">=</span><span class="va">True</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>LATITUDE             0
LONGITUDE            0
PARCELNO             0
SALE_PRC             0
LND_SQFOOT           0
TOT_LVG_AREA         0
SPEC_FEAT_VAL        0
RAIL_DIST            0
OCEAN_DIST           0
WATER_DIST           0
CNTR_DIST            0
SUBCNTR_DI           0
HWY_DIST             0
age                  0
avno60plus           0
month_sold           0
structure_quality    0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>df.duplicated().<span class="bu">any</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>df.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LATITUDE</th>
<th data-quarto-table-cell-role="th">LONGITUDE</th>
<th data-quarto-table-cell-role="th">PARCELNO</th>
<th data-quarto-table-cell-role="th">SALE_PRC</th>
<th data-quarto-table-cell-role="th">LND_SQFOOT</th>
<th data-quarto-table-cell-role="th">TOT_LVG_AREA</th>
<th data-quarto-table-cell-role="th">SPEC_FEAT_VAL</th>
<th data-quarto-table-cell-role="th">RAIL_DIST</th>
<th data-quarto-table-cell-role="th">OCEAN_DIST</th>
<th data-quarto-table-cell-role="th">WATER_DIST</th>
<th data-quarto-table-cell-role="th">CNTR_DIST</th>
<th data-quarto-table-cell-role="th">SUBCNTR_DI</th>
<th data-quarto-table-cell-role="th">HWY_DIST</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">avno60plus</th>
<th data-quarto-table-cell-role="th">month_sold</th>
<th data-quarto-table-cell-role="th">structure_quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">LATITUDE</td>
<td>1.000000</td>
<td>0.721232</td>
<td>-0.165487</td>
<td>0.047701</td>
<td>-0.077481</td>
<td>-0.193972</td>
<td>-0.007634</td>
<td>-0.172382</td>
<td>0.242735</td>
<td>-0.423396</td>
<td>-0.717348</td>
<td>-0.195823</td>
<td>-0.113443</td>
<td>0.416967</td>
<td>0.081366</td>
<td>-0.023634</td>
<td>0.391989</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LONGITUDE</td>
<td>0.721232</td>
<td>1.000000</td>
<td>-0.432816</td>
<td>0.195274</td>
<td>0.018242</td>
<td>-0.181007</td>
<td>-0.009372</td>
<td>-0.303155</td>
<td>-0.457477</td>
<td>-0.764256</td>
<td>-0.791968</td>
<td>-0.380220</td>
<td>-0.216406</td>
<td>0.488757</td>
<td>0.059416</td>
<td>-0.010859</td>
<td>0.132893</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">PARCELNO</td>
<td>-0.165487</td>
<td>-0.432816</td>
<td>1.000000</td>
<td>-0.204068</td>
<td>0.071381</td>
<td>0.102439</td>
<td>0.055152</td>
<td>0.223387</td>
<td>0.289232</td>
<td>0.295951</td>
<td>0.419933</td>
<td>0.243888</td>
<td>0.018247</td>
<td>-0.270718</td>
<td>-0.160925</td>
<td>0.011129</td>
<td>0.044652</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SALE_PRC</td>
<td>0.047701</td>
<td>0.195274</td>
<td>-0.204068</td>
<td>1.000000</td>
<td>0.363077</td>
<td>0.667301</td>
<td>0.497500</td>
<td>-0.077009</td>
<td>-0.274675</td>
<td>-0.127938</td>
<td>-0.271425</td>
<td>-0.370078</td>
<td>0.231877</td>
<td>-0.123408</td>
<td>-0.027026</td>
<td>0.000325</td>
<td>0.383995</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">LND_SQFOOT</td>
<td>-0.077481</td>
<td>0.018242</td>
<td>0.071381</td>
<td>0.363077</td>
<td>1.000000</td>
<td>0.437472</td>
<td>0.390707</td>
<td>-0.083901</td>
<td>-0.161579</td>
<td>-0.055093</td>
<td>-0.023181</td>
<td>-0.159094</td>
<td>0.130488</td>
<td>0.101244</td>
<td>-0.005899</td>
<td>0.005926</td>
<td>-0.006686</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">TOT_LVG_AREA</td>
<td>-0.193972</td>
<td>-0.181007</td>
<td>0.102439</td>
<td>0.667301</td>
<td>0.437472</td>
<td>1.000000</td>
<td>0.506064</td>
<td>0.075486</td>
<td>-0.050141</td>
<td>0.148343</td>
<td>0.136526</td>
<td>-0.044882</td>
<td>0.229497</td>
<td>-0.340606</td>
<td>-0.056545</td>
<td>0.002517</td>
<td>0.173422</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SPEC_FEAT_VAL</td>
<td>-0.007634</td>
<td>-0.009372</td>
<td>0.055152</td>
<td>0.497500</td>
<td>0.390707</td>
<td>0.506064</td>
<td>1.000000</td>
<td>-0.021965</td>
<td>-0.055155</td>
<td>0.013923</td>
<td>-0.048817</td>
<td>-0.151916</td>
<td>0.153770</td>
<td>-0.098780</td>
<td>-0.008879</td>
<td>-0.014012</td>
<td>0.188030</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">RAIL_DIST</td>
<td>-0.172382</td>
<td>-0.303155</td>
<td>0.223387</td>
<td>-0.077009</td>
<td>-0.083901</td>
<td>0.075486</td>
<td>-0.021965</td>
<td>1.000000</td>
<td>0.258966</td>
<td>0.162313</td>
<td>0.444494</td>
<td>0.485468</td>
<td>-0.092495</td>
<td>-0.234515</td>
<td>-0.116955</td>
<td>0.010560</td>
<td>-0.074075</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCEAN_DIST</td>
<td>0.242735</td>
<td>-0.457477</td>
<td>0.289232</td>
<td>-0.274675</td>
<td>-0.161579</td>
<td>-0.050141</td>
<td>-0.055155</td>
<td>0.258966</td>
<td>1.000000</td>
<td>0.490764</td>
<td>0.245396</td>
<td>0.425869</td>
<td>0.093500</td>
<td>-0.159409</td>
<td>0.035215</td>
<td>-0.012723</td>
<td>0.209497</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">WATER_DIST</td>
<td>-0.423396</td>
<td>-0.764256</td>
<td>0.295951</td>
<td>-0.127938</td>
<td>-0.055093</td>
<td>0.148343</td>
<td>0.013923</td>
<td>0.162313</td>
<td>0.490764</td>
<td>1.000000</td>
<td>0.526952</td>
<td>0.195280</td>
<td>0.400233</td>
<td>-0.330578</td>
<td>-0.096339</td>
<td>0.010556</td>
<td>-0.034343</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">CNTR_DIST</td>
<td>-0.717348</td>
<td>-0.791968</td>
<td>0.419933</td>
<td>-0.271425</td>
<td>-0.023181</td>
<td>0.136526</td>
<td>-0.048817</td>
<td>0.444494</td>
<td>0.245396</td>
<td>0.526952</td>
<td>1.000000</td>
<td>0.766387</td>
<td>0.076484</td>
<td>-0.548287</td>
<td>-0.130857</td>
<td>0.023096</td>
<td>-0.330588</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SUBCNTR_DI</td>
<td>-0.195823</td>
<td>-0.380220</td>
<td>0.243888</td>
<td>-0.370078</td>
<td>-0.159094</td>
<td>-0.044882</td>
<td>-0.151916</td>
<td>0.485468</td>
<td>0.425869</td>
<td>0.195280</td>
<td>0.766387</td>
<td>1.000000</td>
<td>-0.093982</td>
<td>-0.385278</td>
<td>-0.073202</td>
<td>0.016334</td>
<td>-0.248656</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">HWY_DIST</td>
<td>-0.113443</td>
<td>-0.216406</td>
<td>0.018247</td>
<td>0.231877</td>
<td>0.130488</td>
<td>0.229497</td>
<td>0.153770</td>
<td>-0.092495</td>
<td>0.093500</td>
<td>0.400233</td>
<td>0.076484</td>
<td>-0.093982</td>
<td>1.000000</td>
<td>-0.120505</td>
<td>-0.019788</td>
<td>-0.004547</td>
<td>0.193529</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">age</td>
<td>0.416967</td>
<td>0.488757</td>
<td>-0.270718</td>
<td>-0.123408</td>
<td>0.101244</td>
<td>-0.340606</td>
<td>-0.098780</td>
<td>-0.234515</td>
<td>-0.159409</td>
<td>-0.330578</td>
<td>-0.548287</td>
<td>-0.385278</td>
<td>-0.120505</td>
<td>1.000000</td>
<td>0.110325</td>
<td>-0.038904</td>
<td>0.009253</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">avno60plus</td>
<td>0.081366</td>
<td>0.059416</td>
<td>-0.160925</td>
<td>-0.027026</td>
<td>-0.005899</td>
<td>-0.056545</td>
<td>-0.008879</td>
<td>-0.116955</td>
<td>0.035215</td>
<td>-0.096339</td>
<td>-0.130857</td>
<td>-0.073202</td>
<td>-0.019788</td>
<td>0.110325</td>
<td>1.000000</td>
<td>-0.020870</td>
<td>0.096050</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">month_sold</td>
<td>-0.023634</td>
<td>-0.010859</td>
<td>0.011129</td>
<td>0.000325</td>
<td>0.005926</td>
<td>0.002517</td>
<td>-0.014012</td>
<td>0.010560</td>
<td>-0.012723</td>
<td>0.010556</td>
<td>0.023096</td>
<td>0.016334</td>
<td>-0.004547</td>
<td>-0.038904</td>
<td>-0.020870</td>
<td>1.000000</td>
<td>-0.011023</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">structure_quality</td>
<td>0.391989</td>
<td>0.132893</td>
<td>0.044652</td>
<td>0.383995</td>
<td>-0.006686</td>
<td>0.173422</td>
<td>0.188030</td>
<td>-0.074075</td>
<td>0.209497</td>
<td>-0.034343</td>
<td>-0.330588</td>
<td>-0.248656</td>
<td>0.193529</td>
<td>0.009253</td>
<td>0.096050</td>
<td>-0.011023</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>df.drop([<span class="st">'LONGITUDE'</span>, <span class="st">'WATER_DIST'</span>], axis<span class="op">=</span><span class="dv">1</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>low_corr_features <span class="op">=</span> [<span class="st">'PARCELNO'</span>, <span class="st">'age'</span>, <span class="st">'avno60plus'</span>, <span class="st">'month_sold'</span>]</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>df.drop(low_corr_features, axis<span class="op">=</span><span class="dv">1</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>df.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LATITUDE</th>
<th data-quarto-table-cell-role="th">SALE_PRC</th>
<th data-quarto-table-cell-role="th">LND_SQFOOT</th>
<th data-quarto-table-cell-role="th">TOT_LVG_AREA</th>
<th data-quarto-table-cell-role="th">SPEC_FEAT_VAL</th>
<th data-quarto-table-cell-role="th">RAIL_DIST</th>
<th data-quarto-table-cell-role="th">OCEAN_DIST</th>
<th data-quarto-table-cell-role="th">CNTR_DIST</th>
<th data-quarto-table-cell-role="th">SUBCNTR_DI</th>
<th data-quarto-table-cell-role="th">HWY_DIST</th>
<th data-quarto-table-cell-role="th">structure_quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">LATITUDE</td>
<td>1.000000</td>
<td>0.047701</td>
<td>-0.077481</td>
<td>-0.193972</td>
<td>-0.007634</td>
<td>-0.172382</td>
<td>0.242735</td>
<td>-0.717348</td>
<td>-0.195823</td>
<td>-0.113443</td>
<td>0.391989</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SALE_PRC</td>
<td>0.047701</td>
<td>1.000000</td>
<td>0.363077</td>
<td>0.667301</td>
<td>0.497500</td>
<td>-0.077009</td>
<td>-0.274675</td>
<td>-0.271425</td>
<td>-0.370078</td>
<td>0.231877</td>
<td>0.383995</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">LND_SQFOOT</td>
<td>-0.077481</td>
<td>0.363077</td>
<td>1.000000</td>
<td>0.437472</td>
<td>0.390707</td>
<td>-0.083901</td>
<td>-0.161579</td>
<td>-0.023181</td>
<td>-0.159094</td>
<td>0.130488</td>
<td>-0.006686</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">TOT_LVG_AREA</td>
<td>-0.193972</td>
<td>0.667301</td>
<td>0.437472</td>
<td>1.000000</td>
<td>0.506064</td>
<td>0.075486</td>
<td>-0.050141</td>
<td>0.136526</td>
<td>-0.044882</td>
<td>0.229497</td>
<td>0.173422</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SPEC_FEAT_VAL</td>
<td>-0.007634</td>
<td>0.497500</td>
<td>0.390707</td>
<td>0.506064</td>
<td>1.000000</td>
<td>-0.021965</td>
<td>-0.055155</td>
<td>-0.048817</td>
<td>-0.151916</td>
<td>0.153770</td>
<td>0.188030</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">RAIL_DIST</td>
<td>-0.172382</td>
<td>-0.077009</td>
<td>-0.083901</td>
<td>0.075486</td>
<td>-0.021965</td>
<td>1.000000</td>
<td>0.258966</td>
<td>0.444494</td>
<td>0.485468</td>
<td>-0.092495</td>
<td>-0.074075</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OCEAN_DIST</td>
<td>0.242735</td>
<td>-0.274675</td>
<td>-0.161579</td>
<td>-0.050141</td>
<td>-0.055155</td>
<td>0.258966</td>
<td>1.000000</td>
<td>0.245396</td>
<td>0.425869</td>
<td>0.093500</td>
<td>0.209497</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CNTR_DIST</td>
<td>-0.717348</td>
<td>-0.271425</td>
<td>-0.023181</td>
<td>0.136526</td>
<td>-0.048817</td>
<td>0.444494</td>
<td>0.245396</td>
<td>1.000000</td>
<td>0.766387</td>
<td>0.076484</td>
<td>-0.330588</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SUBCNTR_DI</td>
<td>-0.195823</td>
<td>-0.370078</td>
<td>-0.159094</td>
<td>-0.044882</td>
<td>-0.151916</td>
<td>0.485468</td>
<td>0.425869</td>
<td>0.766387</td>
<td>1.000000</td>
<td>-0.093982</td>
<td>-0.248656</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HWY_DIST</td>
<td>-0.113443</td>
<td>0.231877</td>
<td>0.130488</td>
<td>0.229497</td>
<td>0.153770</td>
<td>-0.092495</td>
<td>0.093500</td>
<td>0.076484</td>
<td>-0.093982</td>
<td>1.000000</td>
<td>0.193529</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">structure_quality</td>
<td>0.391989</td>
<td>0.383995</td>
<td>-0.006686</td>
<td>0.173422</td>
<td>0.188030</td>
<td>-0.074075</td>
<td>0.209497</td>
<td>-0.330588</td>
<td>-0.248656</td>
<td>0.193529</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">'CNTR_DIST'</span>], bins<span class="op">=</span><span class="dv">30</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of CNTR_DIST'</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-76-output-1.png" width="676" height="523"></p>
</div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">'OCEAN_DIST'</span>, y<span class="op">=</span><span class="st">'SALE_PRC'</span>, data<span class="op">=</span>df)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Regression plot of OCEAN_DIST vs. SALE_PRC'</span>)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-77-output-1.png" width="663" height="523"></p>
</div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'LND_SQFOOT'</span>, y<span class="op">=</span><span class="st">'SALE_PRC'</span>, data<span class="op">=</span>df)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter plot of LND_SQFOOT vs. SALE_PRC'</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-78-output-1.png" width="663" height="523"></p>
</div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">'SALE_PRC'</span>], bins<span class="op">=</span><span class="dv">30</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of SALE_PRC'</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-79-output-1.png" width="676" height="523"></p>
</div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"darkgrid"</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>color_palette <span class="op">=</span> <span class="st">"viridis"</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>sns.relplot(x<span class="op">=</span><span class="st">'CNTR_DIST'</span>, y<span class="op">=</span><span class="st">'SALE_PRC'</span>, sizes<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">100</span>), hue<span class="op">=</span><span class="st">'TOT_LVG_AREA'</span>, palette<span class="op">=</span>color_palette, size<span class="op">=</span><span class="st">'SALE_PRC'</span>, data<span class="op">=</span>df)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Distance to Miami Central Business'</span>)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Sale Price'</span>)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>plt.ticklabel_format(style<span class="op">=</span><span class="st">'plain'</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-80-output-1.png" width="637" height="445"></p>
</div>
</div>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'HWY_DIST'</span>, y<span class="op">=</span><span class="st">'SALE_PRC'</span>, data<span class="op">=</span>df)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter plot of HWY_DIST vs. SALE_PRC'</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-81-output-1.png" width="608" height="455"></p>
</div>
</div>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">'RAIL_DIST'</span>], bins<span class="op">=</span><span class="dv">30</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of RAIL_DIST'</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-82-output-1.png" width="608" height="455"></p>
</div>
</div>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="st">'LATITUDE'</span>, <span class="st">'LONGITUDE'</span>, <span class="st">'LND_SQFOOT'</span>, <span class="st">'TOT_LVG_AREA'</span>, <span class="st">'SPEC_FEAT_VAL'</span>, <span class="st">'RAIL_DIST'</span>, <span class="st">'OCEAN_DIST'</span>, <span class="st">'WATER_DIST'</span>, <span class="st">'CNTR_DIST'</span>, <span class="st">'SUBCNTR_DI'</span>, <span class="st">'HWY_DIST'</span>, <span class="st">'age'</span>, <span class="st">'avno60plus'</span>, <span class="st">'month_sold'</span>, <span class="st">'structure_quality'</span>]</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="st">'SALE_PRC'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'miami-housing.csv'</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[features]</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[target]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df[features <span class="op">+</span> [target]].corr()</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix,  cmap<span class="op">=</span><span class="st">"coolwarm"</span>, fmt<span class="op">=</span><span class="st">".2f"</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix)):</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix)):</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>        plt.text(j <span class="op">+</span> <span class="fl">0.5</span>, i <span class="op">+</span> <span class="fl">0.5</span>, <span class="ss">f"</span><span class="sc">{</span>correlation_matrix<span class="sc">.</span>iloc[i, j]<span class="sc">:.2f}</span><span class="ss">"</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Correlation Heatmap"</span>)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-85-output-1.png" width="848" height="615"></p>
</div>
</div>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[target], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribution of Sale Price"</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sale Price"</span>)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-86-output-1.png" width="597" height="455"></p>
</div>
</div>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>gb_model <span class="op">=</span> GradientBoostingRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, learning_rate<span class="op">=</span><span class="fl">0.1</span>, max_depth<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> gb_model.fit(X_train, y_train)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>r2_score(y_pred,y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>0.8775410609127824</code></pre>
</div>
</div>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>fea_importances <span class="op">=</span> model.feature_importances_</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>fea_importance_df <span class="op">=</span> pd.DataFrame({<span class="st">'Feature'</span>: features, <span class="st">'Importance'</span>: fea_importances})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>fea_importance_df <span class="op">=</span> fea_importance_df.sort_values(by<span class="op">=</span><span class="st">'Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>plt.barh(fea_importance_df[<span class="st">'Feature'</span>], fea_importance_df[<span class="st">'Importance'</span>])</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Importance'</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Feature Importance'</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-90-output-1.png" width="672" height="455"></p>
</div>
</div>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>chosen_feature <span class="op">=</span> <span class="st">'LATITUDE'</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'SALE_PRC'</span>]</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>poly_features <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>, include_bias<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>X_poly <span class="op">=</span> poly_features.fit_transform(X[[chosen_feature]])</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>lin_reg <span class="op">=</span> LinearRegression()</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>lin_reg.fit(X_poly, y)</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>plt.scatter(X[chosen_feature], y, color<span class="op">=</span><span class="st">'r'</span>, label<span class="op">=</span><span class="st">'Original Data'</span>)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>X_line <span class="op">=</span> np.linspace(X[chosen_feature].<span class="bu">min</span>(), X[chosen_feature].<span class="bu">max</span>(), <span class="dv">100</span>).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>X_line_poly <span class="op">=</span> poly_features.transform(X_line)</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>y_line_pred <span class="op">=</span> lin_reg.predict(X_line_poly)</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>plt.plot(X_line, y_line_pred, color<span class="op">=</span><span class="st">'b'</span>, label<span class="op">=</span><span class="st">'Polynomial Regression'</span>)</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(chosen_feature)</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'SALE_PRC'</span>)</span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-91-output-1.png" width="606" height="450"></p>
</div>
</div>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>X_train,X_test,y_train,y_test<span class="op">=</span>train_test_split(X,y,test_size<span class="op">=</span><span class="fl">0.2</span>,random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'SALE_PRC'</span>]</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>num_features <span class="op">=</span> X.shape[<span class="dv">1</span>]</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span>num_features, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">2</span><span class="op">*</span>num_features))</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, feature <span class="kw">in</span> <span class="bu">enumerate</span>(X.columns):</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    X_single_feature <span class="op">=</span> X[feature].values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    lin_reg <span class="op">=</span> LinearRegression()</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    lin_reg.fit(X_single_feature, y)</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    axes[i].scatter(X[feature], y, color<span class="op">=</span><span class="st">'r'</span>, label<span class="op">=</span><span class="st">'Original Data'</span>)</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    X_line <span class="op">=</span> np.linspace(X[feature].<span class="bu">min</span>(), X[feature].<span class="bu">max</span>(), <span class="dv">100</span>).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    y_line_pred <span class="op">=</span> lin_reg.predict(X_line)</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>    axes[i].plot(X_line, y_line_pred, color<span class="op">=</span><span class="st">'b'</span>, label<span class="op">=</span><span class="st">'Simple Linear Regression'</span>)</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(feature)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>    axes[i].set_ylabel(<span class="st">'SALE_PRC'</span>)</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>    axes[i].legend()</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-93-output-1.png" width="820" height="2298"></p>
</div>
</div>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>poly_features <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>, include_bias<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>X_poly <span class="op">=</span> poly_features.fit_transform(X)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_poly, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>poly_reg_model <span class="op">=</span> LinearRegression()</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>poly_reg_model.fit(X_train, y_train)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> poly_reg_model.score(X_test, y_test)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Polynomial Regression Model Accuracy: </span><span class="sc">{</span>accuracy<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Polynomial Regression Model Accuracy: 0.881111708167996</code></pre>
</div>
</div>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>X_poly.<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>array([[ 2.589e+01, -8.016e+01,  9.375e+03, ...,  6.400e+01,  3.200e+01,
         1.600e+01],
       [ 2.589e+01, -8.015e+01,  9.375e+03, ...,  8.100e+01,  3.600e+01,
         1.600e+01],
       [ 2.589e+01, -8.015e+01,  9.375e+03, ...,  4.000e+00,  8.000e+00,
         1.600e+01],
       ...,
       [ 2.578e+01, -8.026e+01,  8.460e+03, ...,  4.900e+01,  2.800e+01,
         1.600e+01],
       [ 2.578e+01, -8.026e+01,  7.500e+03, ...,  6.400e+01,  3.200e+01,
         1.600e+01],
       [ 2.578e+01, -8.026e+01,  8.833e+03, ...,  1.210e+02,  4.400e+01,
         1.600e+01]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(poly_reg_model.coef_.<span class="bu">round</span>(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[ 1.64638752e+09  1.43501940e+08  1.99361000e+03  7.18771000e+03
  5.72473000e+03  1.09326100e+04 -2.20423400e+04 -2.27902000e+03
  5.99300000e+01 -8.40520000e+02 -1.25848900e+04 -1.22307374e+06
 -1.67500006e+06 -1.76007415e+06  2.15822777e+07  4.92283607e+06
  2.37884737e+07 -7.24700000e+01 -2.26910000e+02 -2.41000000e+01
 -6.05400000e+01  7.95200000e+01  8.66300000e+01  5.84100000e+01
 -5.57000000e+00  4.27100000e+01  9.13476000e+03  1.16614383e+07
 -2.10318000e+03 -8.07204800e+04  4.66524507e+06  1.23000000e+00
  1.33300000e+01  6.36000000e+01  1.16820000e+02 -2.49730000e+02
 -2.30000000e-01  1.92500000e+01 -1.20200000e+01 -1.43320000e+02
 -1.23242000e+04  3.73434037e+06 -2.26988600e+04  2.44413360e+05
 -0.00000000e+00 -0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00 -0.00000000e+00  0.00000000e+00
  0.00000000e+00  1.00000000e-01 -2.84000000e+00  3.00000000e-02
 -3.70000000e-01  1.00000000e-02  0.00000000e+00 -0.00000000e+00
 -0.00000000e+00  0.00000000e+00 -0.00000000e+00  0.00000000e+00
  0.00000000e+00 -2.56000000e+00 -8.56900000e+01 -1.20000000e-01
  2.69200000e+01 -0.00000000e+00  0.00000000e+00  0.00000000e+00
 -0.00000000e+00  0.00000000e+00 -0.00000000e+00  0.00000000e+00
 -4.00000000e-02 -2.83000000e+00  1.00000000e-02  3.50000000e-01
 -0.00000000e+00  0.00000000e+00  0.00000000e+00 -0.00000000e+00
  0.00000000e+00 -0.00000000e+00  1.00000000e-02  4.45000000e+00
  3.00000000e-02  1.29000000e+00 -0.00000000e+00 -0.00000000e+00
 -0.00000000e+00  0.00000000e+00 -0.00000000e+00 -6.00000000e-02
 -1.37300000e+01  3.00000000e-02  6.00000000e-02 -0.00000000e+00
  0.00000000e+00 -0.00000000e+00  0.00000000e+00  8.00000000e-02
  4.09000000e+00  1.00000000e-02  7.20000000e-01 -0.00000000e+00
  0.00000000e+00 -0.00000000e+00 -1.00000000e-02  4.62000000e+01
 -8.00000000e-02 -6.50000000e-01  0.00000000e+00  0.00000000e+00
  3.00000000e-02 -3.48700000e+01  5.00000000e-02  1.60000000e-01
  0.00000000e+00  4.00000000e-02 -1.87100000e+01 -7.00000000e-02
  1.34000000e+00  9.35000000e+00  6.75860000e+02 -1.79900000e+01
  1.14010000e+02  5.66658400e+05  1.42371000e+03 -2.88494500e+04
 -1.58070000e+02 -8.33910000e+02  1.79120600e+04]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(poly_reg_model.intercept_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-15030137122.62008</code></pre>
</div>
</div>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>degree <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span>num_features, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">2</span><span class="op">*</span>num_features))</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(h_pad<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, feature <span class="kw">in</span> <span class="bu">enumerate</span>(X.columns):</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    X_single_feature <span class="op">=</span> X[feature].values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    poly_features <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span>degree, include_bias<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    X_poly <span class="op">=</span> poly_features.fit_transform(X_single_feature)</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    poly_reg <span class="op">=</span> LinearRegression()</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>    poly_reg.fit(X_poly, y)</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    axes[i].scatter(X[feature], y, color<span class="op">=</span><span class="st">'r'</span>, label<span class="op">=</span><span class="st">'Original Data'</span>)</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>    X_line <span class="op">=</span> np.linspace(X[feature].<span class="bu">min</span>(), X[feature].<span class="bu">max</span>(), <span class="dv">100</span>).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>    X_line_poly <span class="op">=</span> poly_features.transform(X_line)</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>    y_line_pred <span class="op">=</span> poly_reg.predict(X_line_poly)</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>    axes[i].plot(X_line, y_line_pred, color<span class="op">=</span><span class="st">'b'</span>, label<span class="op">=</span><span class="ss">f'Polynomial Regression (Degree </span><span class="sc">{</span>degree<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(feature)</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>    axes[i].set_ylabel(<span class="st">'SALE_PRC'</span>)</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>    axes[i].legend()</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-98-output-1.png" width="950" height="2894"></p>
</div>
</div>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>poly_features <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>, include_bias<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>X_poly <span class="op">=</span> poly_features.fit_transform(X)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_poly, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>poly_reg_model <span class="op">=</span> LinearRegression()</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>poly_reg_model.fit(X_train, y_train)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> poly_reg_model.score(X_test, y_test)</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Polynomial Regression Model Accuracy: </span><span class="sc">{</span>accuracy<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Polynomial Regression Model Accuracy: 0.881111708167996</code></pre>
</div>
</div>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>num_features <span class="op">=</span> X.shape[<span class="dv">1</span>]</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>degree <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span>num_features, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">2</span><span class="op">*</span>num_features))</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(h_pad<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, feature <span class="kw">in</span> <span class="bu">enumerate</span>(X.columns):</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    X_single_feature <span class="op">=</span> X[feature].values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>    poly_features <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span>degree, include_bias<span class="op">=</span><span class="va">True</span>) </span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>    X_poly <span class="op">=</span> poly_features.fit_transform(X_single_feature)</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>    poly_reg <span class="op">=</span> LinearRegression()</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>    poly_reg.fit(X_poly, y)</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>    axes[i].scatter(X[feature], y, color<span class="op">=</span><span class="st">'r'</span>, label<span class="op">=</span><span class="st">'Original Data'</span>)</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    X_line <span class="op">=</span> np.linspace(X[feature].<span class="bu">min</span>(), X[feature].<span class="bu">max</span>(), <span class="dv">100</span>).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>    X_line_poly <span class="op">=</span> poly_features.transform(X_line)</span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>    y_line_pred <span class="op">=</span> poly_reg.predict(X_line_poly)</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>    axes[i].plot(X_line, y_line_pred, color<span class="op">=</span><span class="st">'b'</span>, label<span class="op">=</span><span class="ss">f'Polynomial Regression (Degree </span><span class="sc">{</span>degree<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(feature)</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>    axes[i].set_ylabel(<span class="st">'SALE_PRC'</span>)</span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>    axes[i].legend()</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-100-output-1.png" width="971" height="2894"></p>
</div>
</div>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[features]</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>degree <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>poly_features <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span>degree, include_bias<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>X_poly <span class="op">=</span> poly_features.fit_transform(X)</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>poly_feature <span class="op">=</span> poly_features.get_feature_names_out(X.columns)</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>X_poly_df <span class="op">=</span> pd.DataFrame(X_poly, columns<span class="op">=</span>poly_feature)</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_poly_df.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    LATITUDE  LONGITUDE  LND_SQFOOT  TOT_LVG_AREA  SPEC_FEAT_VAL  RAIL_DIST  \
0  25.891031 -80.160561      9375.0        1753.0            0.0     2815.9   
1  25.891324 -80.153968      9375.0        1715.0            0.0     4359.1   
2  25.891334 -80.153740      9375.0        2276.0        49206.0     4412.9   
3  25.891765 -80.152657     12450.0        2058.0        10033.0     4585.0   
4  25.891825 -80.154639     12800.0        1684.0        16681.0     4063.4   

   OCEAN_DIST  WATER_DIST  CNTR_DIST  SUBCNTR_DI  ...  avno60plus^3  \
0     12811.4       347.6    42815.3     37742.2  ...           0.0   
1     10648.4       337.8    43504.9     37340.5  ...           0.0   
2     10574.1       297.1    43530.4     37328.7  ...           0.0   
3     10156.5         0.0    43797.5     37423.2  ...           0.0   
4     10836.8       326.6    43599.7     37550.8  ...           0.0   

   avno60plus^2 month_sold  avno60plus^2 structure_quality  \
0                      0.0                             0.0   
1                      0.0                             0.0   
2                      0.0                             0.0   
3                      0.0                             0.0   
4                      0.0                             0.0   

   avno60plus month_sold^2  avno60plus month_sold structure_quality  \
0                      0.0                                      0.0   
1                      0.0                                      0.0   
2                      0.0                                      0.0   
3                      0.0                                      0.0   
4                      0.0                                      0.0   

   avno60plus structure_quality^2  month_sold^3  \
0                             0.0         512.0   
1                             0.0         729.0   
2                             0.0           8.0   
3                             0.0         729.0   
4                             0.0         343.0   

   month_sold^2 structure_quality  month_sold structure_quality^2  \
0                           256.0                           128.0   
1                           324.0                           144.0   
2                            16.0                            32.0   
3                           324.0                           144.0   
4                           196.0                           112.0   

   structure_quality^3  
0                 64.0  
1                 64.0  
2                 64.0  
3                 64.0  
4                 64.0  

[5 rows x 815 columns]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, LabelEncoder</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, roc_auc_score</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> lightgbm <span class="im">as</span> lgb</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'miami-housing.csv'</span>)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>thresholdPrice <span class="op">=</span> <span class="dv">500000</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Above_Threshold'</span>] <span class="op">=</span> (df[<span class="st">'SALE_PRC'</span>] <span class="op">&gt;</span> thresholdPrice).astype(<span class="bu">int</span>)</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop([<span class="st">'PARCELNO'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'Above_Threshold'</span>].values</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>labelencoder <span class="op">=</span> LabelEncoder()</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> labelencoder.fit_transform(y)   </span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(labels<span class="op">=</span>[<span class="st">'Above_Threshold'</span>, <span class="st">'SALE_PRC'</span>], axis<span class="op">=</span><span class="dv">1</span>)  </span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> np.array(X.columns)</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>scaler.fit(X)</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> scaler.transform(X)</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, Y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>dtrain_lgb <span class="op">=</span> lgb.Dataset(X_train, label<span class="op">=</span>y_train)</span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>lgbm_params <span class="op">=</span> {</span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: <span class="fl">0.05</span>,</span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'boosting_type'</span>: <span class="st">'gbdt'</span>,</span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'objective'</span>: <span class="st">'binary'</span>,</span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'metric'</span>: [<span class="st">'auc'</span>, <span class="st">'binary_logloss'</span>],</span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'num_leaves'</span>: <span class="dv">100</span>,</span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: <span class="dv">10</span></span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a>startLgb <span class="op">=</span> datetime.now()</span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a>clf_lgb <span class="op">=</span> lgb.train(lgbm_params, dtrain_lgb, <span class="dv">50</span>)</span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a>stopLgb <span class="op">=</span> datetime.now()</span>
<span id="cb137-34"><a href="#cb137-34" aria-hidden="true" tabindex="-1"></a>executionTime_lgb <span class="op">=</span> stopLgb <span class="op">-</span> startLgb</span>
<span id="cb137-35"><a href="#cb137-35" aria-hidden="true" tabindex="-1"></a>ypred_lgb <span class="op">=</span> clf_lgb.predict(X_test)</span>
<span id="cb137-36"><a href="#cb137-36" aria-hidden="true" tabindex="-1"></a>ypred_lgb <span class="op">=</span> (ypred_lgb <span class="op">&gt;=</span> <span class="fl">0.5</span>).astype(<span class="bu">int</span>)</span>
<span id="cb137-37"><a href="#cb137-37" aria-hidden="true" tabindex="-1"></a>dtrain_xgb <span class="op">=</span> xgb.DMatrix(X_train, label<span class="op">=</span>y_train)</span>
<span id="cb137-38"><a href="#cb137-38" aria-hidden="true" tabindex="-1"></a>parameters_xgb <span class="op">=</span> {</span>
<span id="cb137-39"><a href="#cb137-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: <span class="dv">10</span>,</span>
<span id="cb137-40"><a href="#cb137-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">'objective'</span>: <span class="st">'binary:logistic'</span>,</span>
<span id="cb137-41"><a href="#cb137-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">'eval_metric'</span>: <span class="st">'auc'</span>,</span>
<span id="cb137-42"><a href="#cb137-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: <span class="fl">0.05</span></span>
<span id="cb137-43"><a href="#cb137-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-44"><a href="#cb137-44" aria-hidden="true" tabindex="-1"></a>startXgb <span class="op">=</span> datetime.now()</span>
<span id="cb137-45"><a href="#cb137-45" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> xgb.train(parameters_xgb, dtrain_xgb, <span class="dv">50</span>)</span>
<span id="cb137-46"><a href="#cb137-46" aria-hidden="true" tabindex="-1"></a>stopXgb <span class="op">=</span> datetime.now()</span>
<span id="cb137-47"><a href="#cb137-47" aria-hidden="true" tabindex="-1"></a>executionTime_xgb <span class="op">=</span> stopXgb <span class="op">-</span> startXgb</span>
<span id="cb137-48"><a href="#cb137-48" aria-hidden="true" tabindex="-1"></a>dtest_xgb <span class="op">=</span> xgb.DMatrix(X_test)</span>
<span id="cb137-49"><a href="#cb137-49" aria-hidden="true" tabindex="-1"></a>ypred_xgb <span class="op">=</span> xg.predict(dtest_xgb)</span>
<span id="cb137-50"><a href="#cb137-50" aria-hidden="true" tabindex="-1"></a>ypred_xgb <span class="op">=</span> (ypred_xgb <span class="op">&gt;=</span> <span class="fl">0.5</span>).astype(<span class="bu">int</span>)</span>
<span id="cb137-51"><a href="#cb137-51" aria-hidden="true" tabindex="-1"></a>cm_xgb <span class="op">=</span> confusion_matrix(y_test, ypred_xgb)</span>
<span id="cb137-52"><a href="#cb137-52" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm_xgb,fmt<span class="op">=</span><span class="st">'g'</span>,cmap<span class="op">=</span><span class="st">"crest"</span> )</span>
<span id="cb137-53"><a href="#cb137-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cm_xgb)):</span>
<span id="cb137-54"><a href="#cb137-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cm_xgb[<span class="dv">0</span>])):</span>
<span id="cb137-55"><a href="#cb137-55" aria-hidden="true" tabindex="-1"></a>        plt.text(j <span class="op">+</span> <span class="fl">0.5</span>, i <span class="op">+</span> <span class="fl">0.5</span>, <span class="bu">str</span>(cm_xgb[i, j]), ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb137-56"><a href="#cb137-56" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Predicted'</span>)</span>
<span id="cb137-57"><a href="#cb137-57" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Actual'</span>)</span>
<span id="cb137-58"><a href="#cb137-58" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'XGBoost Confusion Matrix'</span>)</span>
<span id="cb137-59"><a href="#cb137-59" aria-hidden="true" tabindex="-1"></a>plt.show() </span>
<span id="cb137-60"><a href="#cb137-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"_________________________________________________"</span>)</span>
<span id="cb137-61"><a href="#cb137-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"LGBM execution time is: "</span>, executionTime_lgb )</span>
<span id="cb137-62"><a href="#cb137-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"XGBoost execution time is: "</span>, executionTime_xgb)</span>
<span id="cb137-63"><a href="#cb137-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"_________________________________________________"</span>)</span>
<span id="cb137-64"><a href="#cb137-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Accuracy with LGBM = "</span>, np.mean(ypred_lgb <span class="op">==</span> y_test))</span>
<span id="cb137-65"><a href="#cb137-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Accuracy with XGBoost = "</span>, np.mean(ypred_xgb <span class="op">==</span> y_test))</span>
<span id="cb137-66"><a href="#cb137-66" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"___________________________________________________"</span>)</span>
<span id="cb137-67"><a href="#cb137-67" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"AUC score with LGBM is: "</span>, roc_auc_score(y_test, ypred_lgb))</span>
<span id="cb137-68"><a href="#cb137-68" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"AUC score with XGBoost is: "</span>, roc_auc_score(y_test,ypred_xgb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[LightGBM] [Info] Number of positive: 2015, number of negative: 9130
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.000558 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 2921
[LightGBM] [Info] Number of data points in the train set: 11145, number of used features: 15
[LightGBM] [Info] [binary:BoostFromScore]: pavg=0.180799 -&gt; initscore=-1.510946
[LightGBM] [Info] Start training from score -1.510946
_________________________________________________
LGBM execution time is:  0:00:00.108216
XGBoost execution time is:  0:00:00.233882
_________________________________________________
Accuracy with LGBM =  0.9551489056332975
Accuracy with XGBoost =  0.9529960531036957
___________________________________________________
AUC score with LGBM is:  0.9180927441443535
AUC score with XGBoost is:  0.9174731495161104</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-102-output-2.png" width="572" height="455"></p>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>